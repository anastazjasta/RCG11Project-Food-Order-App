(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./src/app/admin/shared/tasks/types.ts":function(e,t,i){"use strict";var n=i("./src/common/types/task.ts");i.d(t,"a",function(){return n.c})},"./src/app/exam/build/build-console-loader/build-console-loader.component.html":function(e,t){e.exports='<div class="exam-preloader">\n  <div class="cogs">\n    <div class="cog-left"></div>\n    <div class="cog-right"></div>\n    <div class="cog-center"></div>\n  </div>\n  <div class="preloader-text text-center">\n    Building project, please wait...\n  </div>\n</div>\n'},"./src/app/exam/build/build-console-loader/build-console-loader.component.less":function(e,t,i){},"./src/app/exam/build/build-console/build-console.component.html":function(e,t){e.exports='<exam-build-console-loader ng-if="$ctrl.build.isInProgress()"></exam-build-console-loader>\n<div class="exam-build-console__log" ng-if="$ctrl.logHtml" ng-bind-html="$ctrl.logHtml"></div>\n'},"./src/app/exam/build/build-console/build-console.component.less":function(e,t,i){},"./src/app/exam/build/build-details.component.html":function(e,t){e.exports='{{\n  activeTestClassName = $ctrl.activeTestClassName;\n  activeTestMethod = $ctrl.activeTestMethod;\n  build = $ctrl.build;\n  \'\'\n}}\n<div class="build-details" ng-show="$ctrl.isBuildVisible()">\n  <div class="row">\n    <div class="col-sm-5">\n      <h4 ng-show="build.result.totalTestsCount > 0">\n        <span class="color-danger">Failed tests: {{ build.result.failedTestsCount }}</span>,\n        <span class="color-success">Passed tests: {{ build.result.passedTestsCount }}</span>,\n        Total: {{ build.result.totalTestsCount }} tests\n      </h4>\n      <ul class="test-results-classes" ng-show="build.result.testClasses">\n          <li ng-repeat="testClass in build.result.testClasses"\n              ng-class="{ \'active\' : $ctrl.isTestClassActive(testClass) }"\n              ng-click="$ctrl.toggleTestClass(testClass)">\n            <span class="fa" ng-class="{ \'fa-caret-right\' : !$ctrl.isTestClassActive(testClass), \'fa-caret-down\' : $ctrl.isTestClassActive(testClass) }"></span>\n            <span class="test-class-name">{{ testClass.name }}</span>\n            <span class="text-danger failed-tests-count" ng-show="testClass.failedCount > 0">({{ testClass.failedCount }} failed)</span>\n            <span class="fa fa-check color-success" ng-show="testClass.failedCount === 0"></span>\n            <ul class="test-results-methods" ng-show="$ctrl.isTestClassActive(testClass)">\n              <li ng-repeat="method in testClass.methods"\n                  ng-class="{ \'active\' : $ctrl.isTestMethodActive(testClass, method) }" ng-click="$ctrl.activateTestMethod(testClass,method, $event)">\n                <span class="test-method-name"><i class="fa" ng-class="{ \'fa-check-circle text-success\' : !method.failed, \'fa-times-circle text-danger\' : method.failed}" aria-hidden="true"></i> {{ method.name }}</span>\n              </li>\n            </ul>\n          </li>\n        </ul>\n    </div>\n    <div class="col-sm-7">\n      <div class="test-method-details" ng-if="activeTestMethod">\n        <h5>{{ activeTestClassName }}</h5>\n        <h4 title="{{ activeTestMethod.name }}">{{ activeTestMethod.name }}</h4>\n        <pre ng-if="activeTestMethod.failed" class="color-danger">{{ activeTestMethod.message }}</pre>\n        <p ng-if="!activeTestMethod.failed" class="color-success">\n          <i class="fa fa-check" aria-hidden="true"></i> Test passed, no details available\n        </p>\n      </div>\n    </div>\n  </div>\n</div>\n'},"./src/app/exam/build/build-details.component.less":function(e,t,i){},"./src/app/exam/build/build-panel.component.html":function(e,t){e.exports='<div class="build-panel">\n  <div class="build-console-wrapper">\n    <exam-build-console ng-if="$ctrl.lastBuild" build="$ctrl.lastBuild"></exam-build-console>\n\n    <div class="px-2 py-5 text-center" ng-show="!$ctrl.lastBuild && !$ctrl.lastBuild.isInProgress()">\n      <button dvsk-button class="mx-1" ng-click="$ctrl.buildProject()">\n        <i class="fa fa-play-circle" aria-hidden="true"></i>\n        <span>{{ $ctrl.isQuickBuildSupported() ? \'Build project (Full)\' : \'Build project\' }}</span>\n      </button>\n      <button dvsk-button class="mx-1" ng-click="$ctrl.quickBuildProject()" ng-if="$ctrl.isQuickBuildSupported()">\n        <i class="fa fa-play-circle" aria-hidden="true"></i>\n        <span>Build project (Quick - tests only)</span>\n      </button>\n    </div>\n  </div>\n</div>\n'},"./src/app/exam/build/build-panel.component.less":function(e,t,i){},"./src/app/exam/build/build-project-button.directive.html":function(e,t){e.exports='<i class="fa fa-play-circle" aria-hidden="true"></i>\n<span ng-if="!$ctrl.isBuildInProgress() && !$ctrl.isQuickBuildSupported()">Build & run tests</span>\n<span ng-if="!$ctrl.isBuildInProgress() && $ctrl.isQuickBuildSupported() && $ctrl.quickBuild">Run quick build (tests only)</span>\n<span ng-if="!$ctrl.isBuildInProgress() && $ctrl.isQuickBuildSupported() && !$ctrl.quickBuild">Run full build</span>\n<span ng-if="$ctrl.isBuildInProgress()">Build in progress...</span>\n'},"./src/app/exam/build/sql-build-panel/sql-build-panel.component.html":function(e,t){e.exports='{{\n  lastBuild = $ctrl.lastBuild;\n  \'\'\n}}\n<div class="build-panel sql-console">\n  <div class="build-console-wrapper">\n    <exam-build-console-loader ng-if="lastBuild.isInProgress()"></exam-build-console-loader>\n\n    <div class="px-2 py-5 text-center" ng-show="!lastBuild">\n      <button dvsk-button ng-click="$ctrl.buildProject()">\n        <i class="fa fa-play-circle" aria-hidden="true"></i>\n        <span>Run & validate</span>\n      </button>\n    </div>\n    <div class="sql-result" ng-show="lastBuild && !lastBuild.isInProgress()">\n      <div class="clearfix">\n        <button dvsk-button class="mt-n1 float-right" ng-click="$ctrl.buildProject()">\n          <i class="fa fa-play-circle" aria-hidden="true"></i>\n          <span>Run & validate</span>\n        </button>\n        <span class="d-block pt-2">\n          Status:\n          <strong class="color-warning" ng-show="lastBuild.isTestFailure() && !lastBuild.isSqlQueryError()">\n            Validation failed\n          </strong>\n          <strong class="color-danger" ng-show="lastBuild.isFailure() || lastBuild.isSqlQueryError()">\n            Error\n          </strong>\n          <strong class="color-success" ng-show="lastBuild.isSuccess()">\n            Success\n          </strong>\n        </span>\n      </div>\n\n      <div class="sql-build-details-wrapper" ng-show="lastBuild.getSqlTestResult()">\n        <code\n          class="color-danger"\n          ng-show="lastBuild.isSqlQueryError() && !lastBuild.getSqlQueryResult() && !lastBuild.getSqlExpectedResult()"\n        >{{ lastBuild.getSqlErrorMessage() }}</code>\n        <div class="build-details" ng-if="lastBuild.getSqlQueryResult() || lastBuild.getSqlExpectedResult()">\n          <div class="row">\n            <div class="col-sm-6">\n              <h4>Query results</h4>\n              <code\n                class="color-danger"\n                ng-show="lastBuild.isSqlQueryError() && (lastBuild.getSqlQueryResult() || lastBuild.getSqlExpectedResult())"\n              >{{ lastBuild.getSqlErrorMessage() }}</code>\n              <p ng-show="!lastBuild.getSqlQueryResult()">No results found</p>\n              <table ng-show="lastBuild.getSqlQueryResult().length" aria-label="Query results">\n                <thead class="sr-only">\n                  <tr>\n                    <th colspan="{{ lastBuild.getSqlQueryResult().length }}" scope="col">Query results</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr ng-repeat="row in lastBuild.getSqlQueryResult() track by $index">\n                    <td ng-repeat="col in row track by $index">{{ col }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            <div class="col-sm-6">\n              <h4>Expected results</h4>\n              <p ng-show="!lastBuild.getSqlExpectedResult()">No results found</p>\n              <table ng-show="lastBuild.getSqlExpectedResult().length" aria-label="Expected results">\n                <thead class="sr-only">\n                  <tr>\n                    <th colspan="{{ lastBuild.getSqlExpectedResult().length }}" scope="col">Expected results</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr ng-repeat="row in lastBuild.getSqlExpectedResult() track by $index">\n                    <td ng-repeat="col in row track by $index">{{ col }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="sql-error sql-build-details-wrapper" ng-show="lastBuild && !lastBuild.getSqlTestResult() && lastBuild.isTestFailure()">\n      <strong class="color-danger">Internal Server Error:</strong>\n      <code>{{ lastBuild.result.details[0].message | json }}</code>\n    </div>\n  </div>\n</div>\n'},"./src/app/exam/comments/comments-panel.component.html":function(e,t){e.exports='<div class="comments-panel">\n  <div class="block-flat comments-container">\n    <div class="header">\n      <h3>Comments</h3>\n    </div>\n    <div class="content" style="display: block;">\n\n      <div class="comments-panel-content">\n        <div class="alert alert-info alert-white rounded am-fade" ng-show="!$ctrl.isSpectator()">\n          <div class="icon"><i class="fa fa-info-circle" aria-hidden="true"></i></div>\n          Select a code fragment that you would like to comment on and press \'c\' to add a comment.\n        </div>\n\n        <div class="list-group" id="comments-list">\n          <div ng-click="$ctrl.goTo(comment)" class="fd-tile detail clean am-fade-and-scale" ng-repeat="comment in $ctrl.comments"\n               ng-class="{\'comment-edit-mode\' : comment.editMode}">\n\n            <div class="content"><p>{{ comment.text }}</p></div>\n            <small ng-show="comment.hidden"><i class="fa fa-eye-slash" aria-hidden="true"></i> The comment is hidden. Click to show it.</small>\n            <div class="icon"><i class="fa fa-comment-o" aria-hidden="true"></i></div>\n\n            <a href class="details">\n              <i class="fa fa-file" aria-hidden="true"></i>\n              <strong>File: </strong>\n              {{ $ctrl.getFileName(comment.fileHash) }}:{{ comment.startLine + 1 }}-{{ comment.endLine + 1 }}\n              <span><i class="fa fa-arrow-circle-right pull-right" aria-hidden="true"></i></span>\n            </a>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n'},"./src/app/exam/editor/code-violation.component.html":function(e,t){e.exports='<div class="code-violation-marker">Clean code rule violation</div>\n<div class="code-violation-body">\n  <div class="code-violation-severity" ng-class="$ctrl.violationClass">{{ $ctrl.violation.severity }}</div>\n  <div class="code-violation-content">\n    <span ng-if="!$ctrl.violationDescription">{{ $ctrl.violation.rule }}</span>\n    <span ng-if="$ctrl.violationDescription">{{ $ctrl.violationDescription }}</span>\n  </div>\n</div>\n'},"./src/app/exam/editor/code-violation.component.less":function(e,t,i){},"./src/app/exam/editor/confirm-close-modified-file.component.html":function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" ng-click="$ctrl.dismiss()">&times;</button>\n  <h4 class="modal-title">File modification detected</h4>\n</div>\n<div class="modal-body">\n  <p>Do you want to save the changes you made to <strong>{{ $ctrl.file.name }}</strong>?</p>\n  <p>Your changes will be lost if you don\'t save them.</p>\n</div>\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-click="$ctrl.dismiss()">Cancel</button>\n  <button type="button" class="btn btn-default" click-with-promise="$ctrl.revertFile()" disable-siblings="true" on-success="$ctrl.close()">\n    <i class="fa fa-undo" aria-hidden="true"></i> Revert changes\n  </button>\n  <button type="button" class="btn btn-primary" click-with-promise="$ctrl.saveFile()" disable-siblings="true" on-success="$ctrl.close()">\n    <i class="fa fa-save" aria-hidden="true"></i> Save changes\n  </button>\n</div>\n'},"./src/app/exam/editor/exam-code-editor.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i("./node_modules/angular/index.js"),o=(i("./node_modules/angular-hotkeys/build/hotkeys.js"),i("./src/common/code-editor/index.ts")),s=i("./src/common/code-review/code-review.module.ts"),r={selector:"codeViolation",template:i("./src/app/exam/editor/code-violation.component.html"),styles:[i("./src/app/exam/editor/code-violation.component.less")],bindings:{violation:"<"},controller:(a.prototype.$doCheck=function(){var e=this.violation;this.violationClass=e?"code-violation-severity-"+e.severity.toLowerCase():null,this.violationDescription=String(e.description||"").replace(/&lt;/g,"<").replace(/&gt;/g,">")},a)};function a(){}var l=n.module("exam.codeViolation",[]).component(r.selector,r).name,c=i("./src/common/code-review/comment-service.ts"),d=n.module("exam.codeEditor",["cfp.hotkeys",o.a,s.a,l,c.a]).name},"./src/app/exam/files/exam-file-tree.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("./node_modules/angular/index.js"),o=i("./src/common/files/file-tree/index.ts"),s={selector:"newFileModal",template:i("./src/app/exam/files/new-file-modal.component.html"),bindings:{location:"<",locationHash:"<",directoryMode:"<",modalInstance:"<",dismiss:"&"},controller:(r.$inject=["$timeout","FileService"],r.prototype.createFile=function(e){var i=this;if(!e.$invalid&&!this.pending){var t=this.FileService;return this.pending=!0,this.useOptimisticCreateFile?(t.optimisticCreateFile(this.location,this.filename,this.locationHash,this.directoryMode),this.$timeout(function(){var e;i.pending=!1,null!==(e=i.modalInstance)&&void 0!==e&&e.close()},500)):t.createFile(this.location,this.filename,this.locationHash,this.directoryMode).then(function(e){var t;return null!==(t=i.modalInstance)&&void 0!==t&&t.close(),e}).finally(function(){i.pending=!1})}},r)};function r(e,t){this.$timeout=e,this.FileService=t,this.useOptimisticCreateFile=!0,this.fileNamePattern={test:function(e){return/^[a-zA-Z0-9\.\-_]+$/.test(e)&&!String(e).includes("..")}}}var a=n.module("exam.files.fileTree",[o.a]).component(s.selector,s).name},"./src/app/exam/files/modified-files-modal.component.html":function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" ng-click="$ctrl.dismiss()">&times;</button>\n  <h4 class="modal-title">Modified files detected</h4>\n</div>\n<div class="modal-body">Some files have been modified. Do you want to save all the changes and proceed?</div>\n<div class="modal-footer">\n  <button type="button" class="btn btn-default btn-sm" ng-click="$ctrl.dismiss()">Cancel</button>\n  <button\n    type="button" class="btn btn-default" click-with-promise="$ctrl.revertFiles()" disable-siblings="true"\n    on-success="$ctrl.close()"\n  >\n    <i class="fa fa-undo" aria-hidden="true"></i> Revert changes & proceed\n  </button>\n  <button\n    type="button" class="btn btn-primary" click-with-promise="$ctrl.saveFiles()" disable-siblings="true"\n    on-success="$ctrl.close()"\n  >\n    <i class="fa fa-save" aria-hidden="true"></i> Save changes & proceed\n  </button>\n</div>\n'},"./src/app/exam/files/new-file-modal.component.html":function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" ng-click="$ctrl.dismiss()" title="Close">&times;</button>\n  <h4 class="modal-title">\n    <span ng-show="!$ctrl.directoryMode">New file</span>\n    <span ng-show="$ctrl.directoryMode">New directory</span>\n  </h4>\n</div>\n<div class="modal-body form">\n  <form class="form-horizontal" ng-submit="$ctrl.createFile(newFileForm)" name="newFileForm">\n    <div class="form-group"\n         ng-class="{\'has-error\': newFileForm.newFileName.$invalid && newFileForm.newFileName.$dirty, \'has-success\' : newFileForm.newFileName.$valid && newFileForm.newFileName.$dirty }">\n      <label class="col-sm-4 control-label" for="newFileName">\n        <span ng-show="!$ctrl.directoryMode">File name</span>\n        <span ng-show="$ctrl.directoryMode">Directory name</span>\n      </label>\n\n      <div class="col-sm-8">\n        <input type="text" id="newFileName" placeholder="Enter file name" ng-model="$ctrl.filename" name="newFileName"\n               required class="form-control" ng-pattern="$ctrl.fileNamePattern" autocomplete-off autofocus />\n        <span class="error" ng-show="newFileForm.newFileName.$error.pattern">Incorrect file name!</span>\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-sm-4 control-label">Location</label>\n\n      <div class="col-sm-8">\n        <p class="form-control-static detail-content" ng-bind="$ctrl.location"></p>\n\n      </div>\n\n    </div>\n\n  </form>\n\n</div>\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-click="$ctrl.dismiss()">Cancel</button>\n  <button type="button" class="btn btn-primary" click-with-promise="$ctrl.createFile(newFileForm)" disable-siblings="true"\n          ng-disabled="newFileForm.$invalid || $ctrl.pending">\n    <i class="fa" aria-hidden="true" ng-class="{ \'fa-check\': !$ctrl.pending, \'fa-refresh fa-spin\': $ctrl.pending }"></i> Create file\n  </button>\n</div>\n'},"./src/app/exam/steps/code-edit/building-instructions.component.html":function(e,t){e.exports='<div class="building-instructions" ng-if="$ctrl.canShowInstructions()">\n  <h3>How to build a project</h3>\n  <p>It is possible to build the project at any time by clicking the <strong>Build & run tests</strong> button below (in the build console).<br/>\n    <span ng-if="$ctrl.canShowCommands()">You can also build the project locally by executing the following commands:</span>\n  </p>\n  <pre ng-if="$ctrl.canShowCommands()"><code>{{ $ctrl.getInstructions() }}</code></pre>\n</div>\n'},"./src/app/exam/steps/code-edit/code-edit-toolbar.component.html":function(e,t){e.exports='<div class="pull-left action-buttons">\n  <button\n    type="button" class="toolbar-btn"\n    ng-if="$ctrl.isIdeMode()"\n    ng-disabled="!$ctrl.isModified()"\n    uib-tooltip="Save current file" tooltip-append-to-body="true"\n    click-with-promise="$ctrl.saveFile()"\n    disable-siblings="true"\n  >\n    <i class="fa fa-save" aria-hidden="true"></i>\n    <span class="long-label">Save file</span>\n    <span class="label">Save</span>\n  </button>\n  <button\n    type="button" class="toolbar-btn"\n    ng-if="$ctrl.isIdeMode()"\n    ng-disabled="!$ctrl.isModified()"\n    uib-tooltip="Revert changes for current file" tooltip-append-to-body="true"\n    click-with-promise="$ctrl.revertFile()" disable-siblings="true"\n  >\n    <i class="fa fa-undo" aria-hidden="true"></i>\n    <span class="long-label">Revert changes</span>\n    <span class="label">Revert</span>\n  </button>\n  <button\n    type="button" class="toolbar-btn"\n    ng-if="$ctrl.isIdeMode() && ($ctrl.isDownloadModeEnabled() || $ctrl.isGitModeEnabled())"\n    uib-tooltip="Refresh project code with latest saved version" tooltip-append-to-body="true"\n    click-with-promise="$ctrl.refreshProject()" disable-siblings="true"\n  >\n    <i class="fa fa-refresh" aria-hidden="true"></i>\n    <span class="long-label">Refresh project</span>\n    <span class="label">Refresh</span>\n  </button>\n\n  <button build-project-button task="$ctrl.task" ng-if="!$ctrl.isSpectator()" class="toolbar-btn"></button>\n  <button build-project-button task="$ctrl.task" ng-if="!$ctrl.isSpectator() && $ctrl.isQuickBuildSupported()" quick-build="true" class="toolbar-btn"></button>\n</div>\n\n<div class="pull-right" ng-if="!$ctrl.isSpectator()">\n  <div class="fetch-code-buttons" ng-if="$ctrl.isModeChooserEnabled()" id="fetch-code-buttons">\n    <button\n      type="button" class="toolbar-btn clone-repo" id="ide-mode-button"\n      ng-if="$ctrl.isProgrammingModeEnabled()"\n      uib-tooltip="Switch to in-browser editor" tooltip-append-to-body="true"\n      click-with-promise="$ctrl.switchToProgrammingMode()"\n    >\n      <i class="fa dskicn-window-edit" aria-hidden="true"></i>\n      <span class="label">IDE</span>\n    </button>\n    <button\n      type="button" class="toolbar-btn clone-repo" id="clone-repo-button"\n      ng-if="$ctrl.isGitModeEnabled()"\n      ng-click="$ctrl.switchToGitMode()"\n      uib-tooltip="Clone Git repository" tooltip-append-to-body="true"\n    >\n      <i class="fa fa-code-fork" aria-hidden="true"></i>\n      <span class="label">Git</span>\n    </button>\n    <button\n      type="button" class="toolbar-btn download-code" id="download-code-button"\n      ng-if="$ctrl.isDownloadModeEnabled()"\n      ng-click="$ctrl.switchToDownloadMode()"\n      uib-tooltip="Download ZIP with code" tooltip-append-to-body="true"\n    >\n      <i class="fa fa-download" aria-hidden="true"></i>\n      <span class="label">Download</span>\n    </button>\n  </div>\n</div>\n'},"./src/app/exam/steps/code-edit/code-edit-toolbar.component.less":function(e,t,i){},"./src/app/exam/steps/code-edit/coding-step.component.html":function(e,t){e.exports='<div class="step-pane-content code-edit-page" ng-class="{\'with-mode-selector\' : !$ctrl.isModeSelected() }">\n  <programming-task-mode-selector\n    ng-if="!$ctrl.isModeSelected()"\n    switch-to-download-mode="$ctrl.switchToDownloadMode()"\n    switch-to-programming-mode="$ctrl.switchToProgrammingMode()"\n    switch-to-git-mode="$ctrl.switchToGitMode()"\n    in-overtime-mode="$ctrl.inOvertimeMode"\n    exam="$ctrl.exam"\n    task="$ctrl.task"\n    class="programming-task-mode-selector"\n  ></programming-task-mode-selector>\n  <programming-task-editor\n    task="$ctrl.task"\n    layout="$ctrl.layout"\n    coding-mode="$ctrl.codingMode"\n    refresh-project="$ctrl.refreshProject()"\n    in-overtime-mode="$ctrl.inOvertimeMode"\n    switch-to-download-mode="$ctrl.switchToDownloadMode(true)"\n    switch-to-programming-mode="$ctrl.switchToProgrammingMode()"\n    switch-to-git-mode="$ctrl.switchToGitMode(true)"\n    ng-if="$ctrl.isModeSelected()"\n  ></programming-task-editor>\n</div>\n'},"./src/app/exam/steps/code-edit/coding-step.component.less":function(e,t,i){},"./src/app/exam/steps/code-edit/download-mode/download-mode.component.html":function(e,t){e.exports='<section class="download-mode__panel">\n  <h2 class="download-mode__panel-title">2. Download task code</h2>\n  <div class="download-mode__panel-body">\n    <p>Download the project source code as a ZIP archive and edit it locally using your favourite IDE.</p>\n\n    <p class="download-mode__alert">\n      <strong class="important text-uppercase">Important!</strong><br/>\n      Publishing the task on public Git hosting services such as GitHub, GitLab, or Bitbucket is prohibited.\n    </p>\n\n    <a href="{{ $ctrl.codePackageUrl }}" dvsk-button full-width\n      ng-disabled="$ctrl.task.limitedAccess"\n      ng-click="$ctrl.startDownload(this)"\n      target="_blank"\n    >\n      <i class="fa fa-arrow-down" aria-hidden="true"></i>\n      <span>Download code</span>\n    </a>\n\n    <div class="download-mode__alert is-danger mt-3" ng-if="$ctrl.task.limitedAccess">\n      Code download is disabled due to limited task access.\n    </div>\n\n    <exam-building-instructions task="$ctrl.task" class="d-block mt-4"></exam-building-instructions>\n\n    <div ng-if="$ctrl.hasReadOnlyPatterns()" class="mt-4">\n      <h3>Read-only files</h3>\n      <p>The task author might have marked some of the project files as read-only. Any changes to files matching the following patterns will be ignored.</p>\n      <pre><code ng-repeat="pattern in $ctrl.readOnlyPatterns">{{ pattern }}{{ \'\\n\' }}</code></pre>\n    </div>\n  </div>\n</section>\n\n<section class="download-mode__panel">\n  <h2 class="download-mode__panel-title">\n    3. Upload ZIP file <small class="font-weight-normal" style="color: #808a94;">before the time is up</small>\n  </h2>\n  <div class="download-mode__panel-body">\n    <p>\n      Upload a ZIP archive with your modified files. Each new upload will overwrite previous versions.\n    </p>\n\n    <p>\n      The uploaded ZIP file must contain a <code>devskiller.marker</code> file in the\n      same location as in the downloaded ZIP archive.\n      <strong style="color: #fb4c2f;">Do not delete this file from the downloaded archive.</strong>\n    </p>\n\n    <p>\n      The ZIP file with your solution must be <strong>5 MB or less</strong>.\n      Remember to remove all build artifacts, external dependencies, and libraries\n      - the ZIP file should only contain the source code.\n    </p>\n  </div>\n\n  <div ng-if="$ctrl.fileUpload.isSuccess" class="download-mode__panel-footer download-mode__panel-footer--success">\n    <span title="{{ $ctrl.fileUpload.file.name }}">File</span> uploaded successfully\n    <span am-time-ago="$ctrl.fileUpload.completedAt" title="{{ $ctrl.fileUpload.completedAt | localDateTime }}" class="font-weight-normal">\n      on {{ $ctrl.fileUpload.completedAt | localDateTime }}\n    </span>\n  </div>\n\n  <div ng-if="$ctrl.fileUpload.isPending" class="download-mode__panel-footer download-mode__panel-footer--progress">\n    <p>\n      Uploading file <strong>{{ $ctrl.fileUpload.file.name }}</strong> &hellip;\n    </p>\n    <div class="progress progress-striped active">\n      <div ng-style="$ctrl.progressBarStyle()" class="progress-bar progress-bar-success">\n        {{ $ctrl.fileUpload.progress }}%\n      </div>\n    </div>\n  </div>\n\n  <div\n    ng-if="!$ctrl.fileUpload.isPending"\n    class="download-mode__panel-footer download-mode__panel-footer--dropzone"\n    ng-class="{ \'is-active\': $ctrl.shouldShowDropzone }"\n  >\n    <p>Drop your <strong>.ZIP</strong> file anywhere on the page</p>\n    <p>\n      <span class="mr-2">or</span>\n      <dvsk-file-button on-file-select="$ctrl.onFileSelect($files)" size="sm">\n        <i class="fa fa-folder-open" aria-hidden="true"></i>\n        <span>Choose .ZIP file...</span>\n      </dvsk-file-button>\n    </p>\n  </div>\n</section>\n\n<div ng-if="$ctrl.shouldShowDropzone" ngf-drop="$ctrl.onFileSelect($files)" class="download-mode-dropzone"></div>\n'},"./src/app/exam/steps/code-edit/download-mode/download-mode.component.less":function(e,t,i){},"./src/app/exam/steps/code-edit/excel-mode/excel-mode.component.html":function(e,t){e.exports='<div class="tab-container git-mode">\n  <ul class="nav nav-tabs">\n    <li class="active">\n      <a href>\n        <i class="dskicn dskicn-code-fork" aria-hidden="true"></i>\n        <span>Excel task</span>\n      </a>\n    </li>\n  </ul>\n  <div class="tab-content">\n    <div class="tab-pane cont active">\n      <div class="header">\n        <h3>Excel task</h3>\n\n        <p class="push-20">\n          Open your Excel Web App session in a separate tab with the button below.\n          Read the task description thoroughly and solve your task before the time ends.\n        </p>\n\n        <p class="text-center">\n          <a dvsk-button href="{{ $ctrl.task.vmResource.loginUrl }}" target="_blank" rel="noopener noreferrer">\n            Open Excel Web App\n            <i class="fa fa-arrow-circle-right" aria-hidden="true"></i>\n          </a>\n        </p>\n\n        <hr />\n\n        <p class="color-danger push-10-t">\n          <strong>Important:</strong> Please be aware of the remaining time as once it is has expired we will terminate your session.\n        </p>\n      </div>\n    </div>\n  </div>\n</div>\n'},"./src/app/exam/steps/code-edit/git-mode.component.html":function(e,t){e.exports='<div class="tab-container git-mode">\n  <ul class="nav nav-tabs">\n    <li class="active">\n      <a href>\n        <i class="dskicn dskicn-code-fork" aria-hidden="true" style="width: 24px; text-align: center; font-size: 16px;"></i>\n        <span>Working with a GIT repository</span>\n      </a>\n    </li>\n  </ul>\n  <div class="tab-content">\n    <div class="tab-pane cont active">\n      <div class="alert alert-warning alert-block font-s15">\n         <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>\n         <strong>Attention!</strong> Push the changes to the repository before the time is up as it will not be possible afterwards.\n       </div>\n\n      <p>\n        <strong class="color-warning">The use of public Git hosting services such as GitHub, GitLab, or Bitbucket is prohibited.</strong>\n      </p>\n      <div class="row">\n        <div class="col-md-6">\n          <h3>Clone a GIT repository</h3>\n          <p>You can clone a Git repository with the source code of this project and edit it in your favourite IDE.</p>\n\n          <div ng-if="!$ctrl.task.limitedAccess">\n\n            <div class="input-group">\n                <input class="form-control" disabled ng-model="$ctrl.clone.command" type="text">\n                <div class="input-group-btn">\n                  <copy-command-button command="$ctrl.clone.command"></copy-command-button>\n                </div>\n            </div>\n            <div class="text-center push-10-t">\n            </div>\n          </div>\n          <div class="alert alert-warning alert-block" ng-if="task.limitedAccess">\n            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Git repository is disabled due to limited task access!\n          </div>\n\n          <h3>Commit &amp; push your changes</h3>\n          <p>\n            Remember to commit and push your changes to the git repository. You must push your changes to the <code>master</code>\n            branch. You are not allowed to push new branches to the repository.<br/><br/>\n\n            You can use following commands to send your changes:\n          <pre><code>git add .\ngit commit -m "Solution"\ngit push origin master</code></pre>\n          </p>\n        </div>\n        <div class="col-md-6">\n          <exam-building-instructions task="$ctrl.task"></exam-building-instructions>\n          <div ng-if="$ctrl.hasReadOnlyPatterns()">\n            <h3>Read-only files</h3>\n            The task author might have marked some of the project files as read-only. Any commits that contain changes to\n            files matching the following patterns will be rejected!\n            <pre><code>{{ $ctrl.joinedReadOnlyPatterns() }}</code></pre>\n          </div>\n        </div>\n      </div>\n\n\n    </div>\n  </div>\n\n</div>\n'},"./src/app/exam/steps/code-edit/programming-task-editor.component.html":function(e,t){e.exports='<code-edit-toolbar\n  task="$ctrl.task"\n  coding-mode="$ctrl.codingMode"\n  in-overtime-mode="$ctrl.inOvertimeMode"\n  ng-if="$ctrl.codingMode === \'IDE\' || $ctrl.codingMode === \'GIT\' || $ctrl.codingMode === \'DOWNLOAD\'"\n  switch-to-download-mode="$ctrl.switchToDownloadMode()"\n  switch-to-programming-mode="$ctrl.switchToProgrammingMode()"\n  switch-to-git-mode="$ctrl.switchToGitMode()"\n  refresh-project="$ctrl.refreshProject()"\n></code-edit-toolbar>\n<div class="panels-container">\n  <div class="left-sidebar" id="left-sidebar" resizable r-directions="[\'right\']" r-width="$ctrl.layoutManager.sidebarWidth">\n    <div class="collapsed-file-tree" ng-click="$ctrl.layoutManager.showSidebar()" ng-if="$ctrl.layout.fileTreeVisible">\n      <div class="show-file-tree-button">Project files</div>\n    </div>\n    <div class="files-tree" id="files-tree" ng-if="$ctrl.layout.fileTreeVisible">\n\n      <div class="block-flat">\n        <button type="button" class="header header-mobile" ng-click="$ctrl.layoutManager.toggleSidebar()">\n          <h3><i class="fa fa-lg fa-fw fa-files-o" aria-hidden="true"></i> Project files</h3>\n        </button>\n        <div class="header">\n          <span class="fa fa-angle-double-left pull-right" ng-click="$ctrl.layoutManager.collapseSidebar()" uib-tooltip="Hide"\n                tooltip-append-to-body="true"></span>\n          <h3>Project files</h3>\n        </div>\n        <div class="content">\n          <div class="sidebar-button-wrapper">\n            <small><i class="fa fa-info-circle" aria-hidden="true"></i> Right click on node for context menu</small>\n          </div>\n          <file-tree context-menu="true"></file-tree>\n        </div>\n      </div>\n    </div>\n\n\n    <div class="collapsed-problem-description" ng-click="$ctrl.layoutManager.showSidebar()" ng-if="$ctrl.layout.descriptionAtSidebar">\n      <div class="show-problem-description-button">\n        <span ng-if="$ctrl.codingMode === \'DOWNLOAD\'">1.</span>\n        Task description\n      </div>\n    </div>\n    <div class="problem-description-panel" ng-if="$ctrl.layout.descriptionAtSidebar">\n\n      <div class="block-flat">\n        <button type="button" class="header header-mobile" ng-click="$ctrl.layoutManager.toggleSidebar()">\n          <h3>\n            <i class="fa fa-lg fa-fw fa-list-alt" aria-hidden="true"></i>\n            <span ng-if="$ctrl.codingMode === \'DOWNLOAD\'">1.</span>\n            Task description\n          </h3>\n        </button>\n        <div class="header">\n          <div class="pull-right" role="button" aria-label="Toggle description" ng-click="$ctrl.layoutManager.toggleSidebar()" style="height: 100%; padding: .5em;">\n            <i class="fa fa-angle-double-left" aria-hidden="true"></i>\n          </div>\n          <h3>\n            <i class="fa fa-lg fa-fw fa-list-alt" aria-hidden="true"></i>\n            <span ng-if="$ctrl.codingMode === \'DOWNLOAD\'">1.</span>\n            Task description\n          </h3>\n        </div>\n        <div class="content">\n          <div id="task-definition">\n            <div class="question-text" render-markdown content="$ctrl.task.question"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="main-content" id="main-panel"\n       ng-class="{ \'without-build-panel\' : !$ctrl.task.compilable || $ctrl.inOvertimeMode }" resizable\n       r-directions="[\'bottom\']">\n    <div class="expand-editor-button fa fa-expand" ng-click="$ctrl.layoutManager.expandMainPanel()" ng-show="!$ctrl.layoutManager.isMainPanelExpanded()"\n         uib-tooltip="Expand editor" tooltip-placement="left" tooltip-append-to-body="true"></div>\n    <div class="expand-editor-button fa fa-compress" ng-click="$ctrl.layoutManager.compressMainPanel()" ng-show="$ctrl.layoutManager.isMainPanelExpanded()"\n         uib-tooltip="Collapse editor" tooltip-placement="left" tooltip-append-to-body="true"></div>\n    <div class="main-content-wrapper">\n      <div ng-intro-method="showCodeEditingTour" ng-intro-autostart="true" ng-intro-options="tourOptions"></div>\n      <tabbed-editor-container task="$ctrl.task" ng-if="$ctrl.codingMode === \'IDE\'" task-definition-visible="$ctrl.layout.descriptionAtMainPanel">\n        <code-editor class="code-editor-wrapper"></code-editor>\n      </tabbed-editor-container>\n      <git-mode task="$ctrl.task" ng-if="$ctrl.codingMode === \'GIT\'" ></git-mode>\n      <download-mode task="$ctrl.task" ng-if="$ctrl.codingMode === \'DOWNLOAD\'" ></download-mode>\n      <sfscratch-mode task="$ctrl.task" ng-if="$ctrl.codingMode === \'SFSCRATCH\'"></sfscratch-mode>\n      <excel-mode task="$ctrl.task" ng-if="$ctrl.codingMode === \'EXCEL\'"></excel-mode>\n    </div>\n  </div>\n\n  <div class="build-panel-wrapper">\n    <div ng-if="$ctrl.task.compilable && !$ctrl.inOvertimeMode">\n      <div class="build-panel-toolbar">\n        <ul class="build-panel-tabs" role="tablist">\n          <li\n            class="build-panel-tab" role="presentation"\n            ng-class="{\n              \'is-disabled\': !$ctrl.lastBuild,\n              \'is-active\': $ctrl.tabs.is(\'build-console\')\n            }"\n          >\n            <a\n              id="build-console-tab" href="#build-console"\n              role="tab" aria-controls="build-console" aria-selected="{{ $ctrl.tabs.is(\'build-console\') }}"\n              ng-click="$event.preventDefault(); $ctrl.tabs.show(\'build-console\')"\n            >\n              <i class="fa fa-terminal" aria-hidden="true"></i>\n              Build console\n              <i\n                class="fa fa-exclamation-triangle color-warning"\n                ng-if="$ctrl.lastBuild.isTestFailure()"\n                aria-label="Last build: Tests failed"\n                uib-tooltip="Last build: Tests failed"\n                tooltip-append-to-body="true"\n                aria-hidden="true"\n              ></i>\n              <i\n                class="fa fa-times-circle color-danger"\n                ng-if="$ctrl.lastBuild.isFailure()"\n                uib-tooltip="Last build: failed" tooltip-append-to-body="true"\n                aria-label="Last build: failed"\n                aria-hidden="true"\n              ></i>\n              <i\n                class="fa fa-check-circle color-success"\n                ng-if="$ctrl.lastBuild.isSuccess()"\n                uib-tooltip="Last build: Success!" tooltip-append-to-body="true"\n                aria-label="Last build: Success!"\n                aria-hidden="true"\n              ></i>\n            </a>\n          </li>\n          <li\n            class="build-panel-tab" role="presentation"\n            ng-class="{\n              \'is-disabled\': !$ctrl.lastBuild.result.totalTestsCount,\n              \'is-active\': $ctrl.tabs.is(\'test-results\')\n            }"\n          >\n            <a\n              id="test-results-tab" href="#test-results"\n              role="tab" aria-controls="test-results" aria-selected="{{ $ctrl.tabs.is(\'test-results\') }}"\n              ng-click="$event.preventDefault(); $ctrl.lastBuild.result.totalTestsCount && $ctrl.tabs.show(\'test-results\')"\n            >\n              <i class="fa fa-flash" aria-hidden="true"></i>\n              Test results\n              <span\n                class="badge"\n                ng-if="$ctrl.lastBuild.result.totalTestsCount"\n                ng-class="{\n                  \'badge-success\': $ctrl.lastBuild.result.failedTestsCount === 0,\n                  \'badge-warning\': $ctrl.lastBuild.result.failedTestsCount > 0\n                }"\n                uib-tooltip="Tests passed" tooltip-append-to-body="true"\n              >{{$ctrl.lastBuild.result.passedTestsCount}} of {{$ctrl.lastBuild.result.totalTestsCount}}\n              </span>\n            </a>\n          </li>\n        </ul>\n        <div class="build-panel-buttons">\n          <button\n            build-project-button\n            task="$ctrl.task"\n            tabs="$ctrl.tabs"\n            tab="build-console"\n            class="toolbar-btn btn btn-primary"\n            ng-if="!$ctrl.isSpectator()"\n          ></button>\n          <button\n            build-project-button\n            task="$ctrl.task"\n            tabs="$ctrl.tabs"\n            tab="build-console"\n            class="toolbar-btn btn btn-primary"\n            ng-if="!$ctrl.isSpectator() && $ctrl.isQuickBuildSupported()"\n            quick-build="true"\n          ></button>\n\n          <button\n            type="button"\n            class="build-panel-button-toggle"\n            uib-tooltip="Toggle" tooltip-append-to-body="true"\n            ng-click="$ctrl.layoutManager.toggleBuildPanel()"\n            aria-label="Toggle build panel"\n          >\n            <i class="fa fa-angle-double-down" aria-hidden="true"></i>\n          </button>\n        </div>\n      </div>\n      <section class="build-panel-tab-pane" ng-show="$ctrl.tabs.is(\'build-console\')">\n        <build-panel task="$ctrl.task" last-build="$ctrl.lastBuild" tabs="$ctrl.tabs"></build-panel>\n      </section>\n      <section class="build-panel-tab-pane" ng-show="$ctrl.lastBuild.result.totalTestsCount && $ctrl.tabs.is(\'test-results\')">\n        <build-details task="$ctrl.task" style="height: auto;"></build-details>\n      </section>\n    </div>\n  </div>\n\n</div>\n'},"./src/app/exam/steps/code-edit/programming-task-editor.component.less":function(e,t,i){},"./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/download-mode.svg":function(e,t,i){e.exports=i.p+"images/download-mode.e895faf5.svg"},"./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/editor-mode.svg":function(e,t,i){e.exports=i.p+"images/editor-mode.e669341e.svg"},"./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/git-mode.svg":function(e,t,i){e.exports=i.p+"images/git-mode.d1866f48.svg"},"./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/programming-task.svg":function(e,t,i){e.exports=i.p+"images/programming-task.4867d6f5.svg"},"./src/app/exam/steps/code-edit/programming-task-mode-selector/programming-task-mode-selector.component.html":function(e,t){e.exports='<div class="exam-page content-container">\n  <div class="exam-page__content">\n    <img dvsk-src="{{ $ctrl.images.content }}" alt="" class="exam-page__content-image" />\n\n    <div class="exam-page__content-text" ng-if="!$ctrl.inOvertimeMode">\n      <h1>You’re about to start a programming task</h1>\n      <p>\n        Choose the way you would like to edit source code of the project. You will be able to change the\n        selected mode in the top right corner at any time during the test.\n      </p>\n    </div>\n\n    <div class="exam-page__content-text" ng-if="$ctrl.inOvertimeMode">\n      <h1>How you would like to upload your overtime changes?</h1>\n    </div>\n  </div>\n</div>\n\n<div class="task-modes">\n  <div class="task-mode" ng-class="{ \'is-disabled\': !$ctrl.task.gitSolvingStrategyEnabled }">\n    <div class="task-mode-disabled" ng-if="!$ctrl.task.gitSolvingStrategyEnabled">\n      {{$ctrl.optionDisabledCopy}}\n    </div>\n    <img dvsk-src="{{ $ctrl.images.gitMode }}" alt="" />\n    <h2>Git repository</h2>\n    <p>\n      Clone a Git repository to edit the source code of the project in your favourite IDE.\n      You can build the project locally or using the browser.\n    </p>\n    <button\n      dvsk-button size="large"\n      ng-click="$ctrl.switchToGitMode()"\n      ng-disabled="$ctrl.isSpectator() || !$ctrl.task.gitSolvingStrategyEnabled"\n    >\n      Use GIT repository\n    </button>\n  </div>\n\n  <div class="task-mode" ng-class="{ \'is-disabled\': !$ctrl.task.zipSolvingStrategyEnabled }">\n    <div class="task-mode-disabled" ng-if="!$ctrl.task.zipSolvingStrategyEnabled">\n      {{$ctrl.optionDisabledCopy}}\n    </div>\n    <img dvsk-src="{{ $ctrl.images.downloadMode }}" alt="" />\n    <h2>Download / Upload code</h2>\n    <p>\n      Download a ZIP file to edit the source code of the project in your favourite IDE.\n      Remember to upload the ZIP file once you\'re done editing.\n    </p>\n    <button\n      dvsk-button size="large"\n      ng-click="$ctrl.switchToDownloadMode()"\n      ng-disabled="$ctrl.isSpectator() || !$ctrl.task.zipSolvingStrategyEnabled"\n    >\n      Download code\n    </button>\n  </div>\n\n  <div class="task-mode" ng-class="{ \'is-disabled\': !$ctrl.task.webSolvingStrategyEnabled || $ctrl.inOvertimeMode }">\n    <div class="task-mode-disabled" ng-if="!$ctrl.task.webSolvingStrategyEnabled">\n      {{$ctrl.optionDisabledCopy}}\n    </div>\n    <div class="task-mode-disabled" ng-if="$ctrl.task.webSolvingStrategyEnabled && $ctrl.inOvertimeMode">\n      Web browser mode disabled after the time is up.\n    </div>\n    <img dvsk-src="{{ $ctrl.images.editorMode }}" alt="" />\n    <h2>In-browser editor</h2>\n    <p>\n      Use our browser-based editor to edit contents of the source code files.\n      You can also use it to build the project and see results of unit tests.\n    </p>\n    <button\n      dvsk-button size="large"\n      ng-click="$ctrl.switchToProgrammingMode()"\n      ng-disabled="$ctrl.isSpectator() || !$ctrl.task.webSolvingStrategyEnabled || $ctrl.inOvertimeMode"\n    >\n      In-browser editor\n    </button>\n  </div>\n</div>\n'},"./src/app/exam/steps/code-edit/programming-task-mode-selector/programming-task-mode-selector.component.less":function(e,t,i){},"./src/app/exam/steps/code-edit/sfscratch-mode.component.html":function(e,t){e.exports='<div class="tab-container git-mode">\n  <ul class="nav nav-tabs">\n    <li class="active">\n      <a href>\n        <i class="dskicn dskicn-code-fork" aria-hidden="true"></i>\n        <span>How do I connect?</span>\n      </a>\n    </li>\n  </ul>\n  <div class="tab-content">\n    <div class="tab-pane cont active">\n      <div>\n        <div class="header">\n          <h3>How to connect</h3>\n        </div>\n\n        <p class="push-20">\n          Open your Salesforce session in a separate tab with the button below.\n          Read the task description thoroughly and solve your task before the time ends.\n        </p>\n        <button type="button" dvsk-button ng-click="$ctrl.openSalesforce()" class="center-block">\n          Open Salesforce\n          <i class="fa fa-arrow-circle-right" aria-hidden="true"></i>\n        </button>\n\n        <hr />\n\n        <p class="no-margin">\n          <strong>NOTE:</strong> If you are having problems with opening Salesforce session it means that it might have timed out.\n          In this case use below button to refresh the link and try opening Salesforce once again.\n          <br>\n          <button type="button" class="push-10-t center-block" dvsk-button color="secondary" size="sm" ng-click="$ctrl.onRefreshUrl()">Refresh link</button>\n          <p class="text-center color-success font-s12" ng-if="$ctrl.linkRefreshed">Link to Salesforce refreshed successfully</p>\n          <p class="text-center color-danger font-s12" ng-if="$ctrl.errorMessage">{{ $ctrl.errorMessage }}</p>\n        </p>\n\n        <hr />\n\n        <p class="color-danger push-10-t">\n          <strong>Important:</strong> Please be aware of the remaining time as once it is has expired we will terminate your session.\n        </p>\n\n      </div>\n    </div>\n  </div>\n\n</div>\n'},"./src/app/exam/steps/code-review/code-review-step.component.html":function(e,t){e.exports='<div class="step-pane-content code-review-page">\n  <div class="panels-container" code-review-layout="">\n    <div class="left-sidebar" id="left-sidebar" resizable r-directions="[\'right\']" r-width="360">\n      <div class="files-tree" id="files-tree">\n\n        <div class="block-flat">\n          <div class="header">\n            <h3>Project files</h3>\n          </div>\n          <div class="content">\n            <file-tree></file-tree>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="main-content" id="main-panel">\n      <div class="main-content-wrapper">\n        <tabbed-editor-container task="$ctrl.task" readonly="true" task-definition-visible="true">\n          <exam-file-comments-editor\n            file-hash="$ctrl.getActiveFileHash()"\n            comments="$ctrl.task.comments"\n            readonly="$ctrl.isSpectator()"\n          ></exam-file-comments-editor>\n        </tabbed-editor-container>\n      </div>\n    </div>\n\n    <div class="right-sidebar" id="right-sidebar" resizable r-directions="[\'left\']" r-width="320">\n      <comments-panel page-number="$ctrl.pageNumber" comments="$ctrl.task.comments"></comments-panel>\n    </div>\n  </div>\n</div>\n'},"./src/app/exam/steps/exam-steps.module.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"ExamStepsModule",function(){return It});var l=i("./node_modules/angular/index.js"),n=i("./src/common/code-editor/index.ts"),o={selector:"cubiksStep",template:'\n    <div class="text-center push-40-t">\n      <a ng-href="{{ $ctrl.task.testUrl }}" class="btn btn-primary btn-lg">\n        Start Personality assessment\n      </a>\n    </div>\n  ',bindings:{task:"<"},controller:(s.$inject=["$window"],s.prototype.$onInit=function(){this.$window.location.href=this.task.testUrl},s.prototype.$onDestroy=function(){},s)};function s(e){this.$window=e}i("./node_modules/intro.js/intro.js"),i("./node_modules/intro.js/introjs.css"),i("./node_modules/angular-intro.js/src/angular-intro.js");var r=i("./src/app/admin/shared/tasks/types.ts"),c=i("./src/common/enums-definition.ts"),a={selector:"examBuildingInstructions",template:i("./src/app/exam/steps/code-edit/building-instructions.component.html"),bindings:{task:"<"},controller:(d.prototype.$onInit=function(){var e,t=this,i=c.B[this.task.projectType];this.projectType=i||{};var n=null===(e=this.projectType.versions)||void 0===e?void 0:e.find(function(e){return e.value===t.task.projectTypeVersion});this.commands=(null==n?void 0:n.commands)||this.projectType.commands},d.prototype.canShowInstructions=function(){return this.projectType!==r.a.PLAIN},d.prototype.canShowCommands=function(){return this.commands&&0<this.commands.length&&!this.task.hasExternalComponents},d.prototype.getInstructions=function(){var e;return null===(e=this.commands)||void 0===e?void 0:e.join("\n")},d.prototype.$onDestroy=function(){},d)};function d(){}var u={selector:"codeEditToolbar",template:i("./src/app/exam/steps/code-edit/code-edit-toolbar.component.html"),styles:[i("./src/app/exam/steps/code-edit/code-edit-toolbar.component.less")],bindings:{task:"<",codingMode:"<",inOvertimeMode:"<",switchToGitMode:"&",switchToDownloadMode:"&",switchToProgrammingMode:"&",refreshProject:"&"},controller:(p.$inject=["$element","examService","FileService","runtimeInfoService"],p.prototype.$onInit=function(){},p.prototype.isSpectator=function(){return this.examService.isSpectator()},p.prototype.isQuickBuildSupported=function(){return this.runtimeInfoService.isQuickBuildSupported(this.task.projectType,this.task.projectTypeVersion)},p.prototype.isSingleFileMode=function(){var e=this.task;return e&&e.singleFileMode},p.prototype.isModeChooserEnabled=function(){var e=this.task,t=0;return e.zipSolvingStrategyEnabled&&t++,e.gitSolvingStrategyEnabled&&t++,e.webSolvingStrategyEnabled&&t++,1<t},p.prototype.isIdeMode=function(){return"IDE"===this.codingMode},p.prototype.isProgrammingModeEnabled=function(){var e=this.task;return!this.inOvertimeMode&&!!e.webSolvingStrategyEnabled&&!e.singleFileMode&&"IDE"!==this.codingMode},p.prototype.isGitModeEnabled=function(){var e=this.task;return!!e.gitSolvingStrategyEnabled&&!e.singleFileMode&&"GIT"!==this.codingMode},p.prototype.isDownloadModeEnabled=function(){var e=this.task;return!!e.zipSolvingStrategyEnabled&&!e.singleFileMode&&"DOWNLOAD"!==this.codingMode},p.prototype.synchronizeRepo=function(){return this.FileService.synchronizeFiles()},p.prototype.revertFile=function(){return this.FileService.revertActiveFile()},p.prototype.saveFile=function(){return this.FileService.saveActiveFile()},p.prototype.isModified=function(){return this.FileService.isActiveFileModified()},p)};function p(e,t,i,n){this.examService=t,this.FileService=i,this.runtimeInfoService=n,e.addClass(e[0].tagName.toLowerCase())}var h=i("./src/common/types/task.ts"),m=i("./src/app/exam/layout/wait-dialog.component.ts"),f={selector:"codingStep",template:i("./src/app/exam/steps/code-edit/coding-step.component.html"),styles:[i("./src/app/exam/steps/code-edit/coding-step.component.less")],bindings:{exam:"<",task:"<",codingMode:"<",inOvertimeMode:"<"},controller:(v.$inject=["$q","$timeout","dialogs","examService","FileService","firebaseService"],v.prototype.$onInit=function(){var e=this;this.task.singleFileMode&&this.switchToProgrammingMode(),this.task.projectType===h.c.SFSCRATCH&&this.switchToSfScratchMode(),this.task.projectType===h.c.EXCEL&&this.switchToExcelMode();try{this.firebaseService.isEnabled()?this.initFirebaseListener():this.$timeout(function(){e.initFirebaseListener()},3e3)}catch(e){}},v.prototype.initFirebaseListener=function(){var t=this;this.firebaseService.listenToCodeEditorModeChanges(function(e){e&&e.codingMode&&e.codingMode!==t.codingMode&&("IDE"!==e.codingMode||t.inOvertimeMode?"DOWNLOAD"===e.codingMode?t.switchToDownloadMode():"GIT"===e.codingMode?t.switchToGitMode():"SFSCRATCH"===e.codingMode&&t.switchToSfScratchMode():t.switchToProgrammingMode())})},v.prototype.$onDestroy=function(){},v.prototype.isModeSelected=function(){return!!this.codingMode},v.prototype.getCurrentCodingMode=function(){return this.codingMode},v.prototype._doSwitchToProgrammingMode=function(){this.updateLayout("IDE",{fileTreeVisible:!this.task.singleFileMode,descriptionAtSidebar:this.task.singleFileMode,descriptionAtMainPanel:!this.task.singleFileMode,buildPanelAvailable:!0})},v.prototype.switchToProgrammingMode=function(){var e=this;this.task.webSolvingStrategyEnabled&&(this.inOvertimeMode||(this.codingMode&&"IDE"!==this.codingMode?this.FileService.synchronizeFiles().then(function(){e._doSwitchToProgrammingMode()}):this._doSwitchToProgrammingMode()))},v.prototype.refreshProject=function(){var e=this;this.codingMode=void 0;var t=this.dialogs.open({component:m.a.selector,backdrop:"static"});this.$timeout(function(){return e.FileService.synchronizeFiles().then(function(){t.close(),e._doSwitchToProgrammingMode()})},100)},v.prototype.switchToSfScratchMode=function(){this.updateLayout("SFSCRATCH",{fileTreeVisible:!1,descriptionAtSidebar:!0,descriptionAtMainPanel:!1,buildPanelAvailable:!0})},v.prototype.switchToExcelMode=function(){this.updateLayout("EXCEL",{fileTreeVisible:!1,descriptionAtSidebar:!0,descriptionAtMainPanel:!1,buildPanelAvailable:!0})},v.prototype.switchToDownloadMode=function(e){var t=this;return void 0===e&&(e=!1),this.task.zipSolvingStrategyEnabled?(e&&this.FileService.getModifiedFiles().length?this.FileService.checkForModifiedFiles():this.$q.resolve()).then(function(){return t.setSimpleMode("DOWNLOAD")}):this.$q.reject()},v.prototype.switchToGitMode=function(e){var t=this;return void 0===e&&(e=!1),this.task.gitSolvingStrategyEnabled?(e&&this.FileService.getModifiedFiles().length?this.FileService.checkForModifiedFiles():this.$q.resolve()).then(function(){return t.setSimpleMode("GIT")}):this.$q.reject()},v.prototype._updateFirebaseCodeEditorMode=function(){this.firebaseService.setCodeEditorMode(this.codingMode)},v.prototype.setSimpleMode=function(e){this.updateLayout(e,{fileTreeVisible:!1,descriptionAtSidebar:!0,descriptionAtMainPanel:!1,buildPanelAvailable:!0})},v.prototype.updateLayout=function(e,t){this.codingMode=e,Object.assign(this.layout,t),this._updateFirebaseCodeEditorMode(),this.examService.setCodingMode(e)},v)};function v(e,t,i,n,o,s){this.$q=e,this.$timeout=t,this.dialogs=i,this.examService=n,this.FileService=o,this.firebaseService=s,this.layout={fileTreeVisible:!1,descriptionAtSidebar:!1,descriptionAtMainPanel:!1,buildPanelAvailable:!1}}var g=i("./node_modules/angular-moment/angular-moment.js"),b=i("./node_modules/jquery/dist/jquery.js"),y=i("./node_modules/ng-file-upload/index.js"),$={selector:"dvskFileButton",template:i("./src/common/dvsk-ng-components/dvsk-file-button/dvsk-file-button.component.html"),styles:[i("./src/common/dvsk-ng-components/dvsk-file-button/dvsk-file-button.component.less")],transclude:!0,bindings:{size:"@",multiple:"<",fullWidth:"<",onFileSelect:"&"},controller:(S.$inject=["$element","$attrs"],S.prototype.$onChanges=function(){""===this.$attrs.fullWidth&&(this.fullWidth=!0),""===this.$attrs.multiple&&(this.multiple=!0),this.fullWidth?this.$element.attr("full-width",""):this.$element.removeAttr("full-width")},S)};function S(e,t){this.$element=e,this.$attrs=t}var w=l.module("dvsk.fileButton",[y]).component($.selector,$).name,k={selector:"downloadMode",template:i("./src/app/exam/steps/code-edit/download-mode/download-mode.component.html"),styles:[i("./src/app/exam/steps/code-edit/download-mode/download-mode.component.less")],bindings:{task:"<"},controller:(C.$inject=["$interval","$q","$scope","dialogs","examErrorService","examService","FileService","logger","Upload"],C.prototype.$onInit=function(){this.codePackageUrl=this.examService.getCodePackageUrl(),this.readOnlyPatterns=[],this.task.readOnlyPatterns&&0<this.task.readOnlyPatterns.length&&(this.readOnlyPatterns=this.task.readOnlyPatterns.filter(function(e){return"devskiller.json"!==e})),b(document.body).bind("dragenter",this.onDragEnter).bind("dragleave",this.onDragLeave),window.addEventListener("dragover",this.preventDefault,!1),window.addEventListener("drop",this.preventDefault,!1)},C.prototype.$onDestroy=function(){b(document.body).unbind("dragenter",this.onDragEnter).unbind("dragleave",this.onDragLeave),window.removeEventListener("dragover",this.preventDefault),window.removeEventListener("drop",this.preventDefault)},C.prototype.preventDefault=function(e){e.preventDefault()},C.prototype.startDownload=function(){},C.prototype.hasReadOnlyPatterns=function(){return 0<this.readOnlyPatterns.length},C.prototype.uploadCodePackage=function(e){var t=this.examService.getCodePackageUrl();return this.logger.debug("Uploading code package to "+t),this.Upload.upload({url:t,withCredentials:!0,method:"POST",headers:{},data:{file:e}})},C.prototype.onFileSelect=function(e){var n=this;this.shouldShowDropzone=!1,this.fileUpload=null;var t=e[0],i=[this.validateFileName(t),this.validateFileSize(t),this.validateFileType(t)],o={file:t},s=this.$q;s.all(i).then(function(){(n.fileUpload=o).isPending=!0,o.progress=0,n.FileService.setSaveInProgress(),n.upload=n.uploadCodePackage(t),n.upload.progress(function(e){n.onProgress(e,o)}).then(function(){Object.assign(o,{progress:100,isSuccess:!0,isFailure:!1,isPending:!1,isComplete:!0,completedAt:new Date}),n.FileService.finishSaveInProgress(),n.FileService.refreshFiles(),n.dialogs.notify("File uploaded","Your code has been uploaded correctly!")},function(e){return Object.assign(o,{isSuccess:!1,isFailure:!0,isPending:!1,isComplete:!0}),n.FileService.finishSaveInProgress(),n.examErrorService.defaultHttpErrorHandlerWithDialog(e,function(e){return 417===e.status?(n.logger.error("No devskiller.marker file in uploaded package"),s.reject({title:"Invalid ZIP file contents",message:"\n                  <p>Your archive doesn't contain a <strong>devskiller.marker</strong> file in its root folder.</p>\n                  <p>Please add an empty devskiller.marker file and upload your code again.</p>\n                "})):415===e.status?(n.logger.error("Wrong content type of uploaded package"),s.reject({title:"File type mismatch",message:"\n                  Your upload failed, because of wrong type of the uploaded file. Only ZIP files are supported.\n                "})):400===e.status||406===e.status||500===e.status?(n.logger.error("Invalid package uploaded, cannot process uploaded archive: "+e.status),s.reject({title:"Unprocessable ZIP file",message:"\n                  Your upload failed. Please check if your file is not too large.\n                  Remove all external dependencies included in the ZIP archive and try again.\n                "})):void 0})})},function(e){var t=e.title,i=e.message;n.dialogs.error(t||"Your solution cannot be uploaded",i)})},C.prototype.onProgress=function(e,t){var i=this;if(!t.isComplete&&(t.progress=.5*(100*e.loaded/e.total|0),50<=t.progress&&!this.serverWaitInterval)){var n=100-t.progress;this.serverWaitInterval=this.$interval(function(){t.progress<100?t.progress+=1:i.serverWaitInterval&&(i.$interval.cancel(i.serverWaitInterval),i.serverWaitInterval=null)},4e3/n)}},C.prototype.validateFileName=function(e){return String(e.name).toLowerCase().endsWith(".zip")?this.$q.resolve():this.$q.reject({title:"File type mismatch",message:"\n            <p>Your solution does not appear to be a valid ZIP archive.</p>\n            <p>Make sure you're uploading a ZIP archive. Other formats, such as RAR, 7-ZIP or GZIP are not supported.</p>\n          "})},C.prototype.validateFileSize=function(e){return e.size&&5242880<e.size?this.$q.reject({title:"Your solution file is too big",message:"\n            <p>The maximum size of the solution file you can upload is <strong>5 MB</strong>.</p>\n            <p>Please make sure that all build artifacts and external dependencies are removed before uploading.</p>\n          "}):this.$q.resolve()},C.prototype.validateFileType=function(e){var c=this;return"undefined"==typeof FileReader?this.$q.resolve():this.$q(function(r,a){var l=new FileReader;l.onload=function(){for(var e="",t=new Uint8Array(l.result),i=0;i<t.length;++i)e+=String.fromCharCode(t[i]);if("PK"!==e.slice(0,4)){for(var n=0,o=[{type:"7-Zip",magic:"7z¼¯'"},{type:"RAR",magic:"Rar!"},{type:"Gzip",magic:"\b"},{type:"Bzip2",magic:"BZh"}];n<o.length;n++){var s=o[n];if(e.slice(0,s.magic.length)===s.magic)return c.logger.error("Wrong content type of uploaded package: "+s.type+" archive"),void a({title:"File type mismatch",message:"\n                  <p>Your solution is not a valid ZIP archive. <strong>"+s.type+" archive detected.</strong></p>\n                  <p>Make sure you're uploading a ZIP archive. Other formats, such as RAR, 7-ZIP or GZIP are not supported.</p>\n                "})}c.logger.error("Wrong content type of uploaded package"),a({title:"File type mismatch",message:"\n              <p>Your solution does not appear to be a valid ZIP archive.</p>\n              <p>Make sure you're uploading a ZIP archive. Other formats, such as RAR, 7-ZIP or GZIP are not supported.</p>\n            "})}else r()},l.readAsArrayBuffer(e.slice(0,10))})},C.prototype.progressBarStyle=function(){var e=this.fileUpload;return null!=e&&e.progress?{width:e.progress+"%"}:{}},C)};function C(e,t,i,n,o,s,r,a,l){var c=this;this.$interval=e,this.$q=t,this.$scope=i,this.dialogs=n,this.examErrorService=o,this.examService=s,this.FileService=r,this.logger=a,this.Upload=l,this.onDragEnter=function(e){var t=e.originalEvent.dataTransfer;t&&(t.dropEffect="copy",c.$scope.$applyAsync(function(){c.shouldShowDropzone=!0}))},this.onDragLeave=function(){c.shouldShowDropzone=!1}}var x=l.module("exam.codeEdit.downloadMode",[g,w]).component(k.selector,k).name,F=i("./src/common/dvsk-ng-components/dvsk-src/dvsk-src.module.ts"),M=(i("./node_modules/angular-hotkeys/build/hotkeys.js"),i("./node_modules/lodash/escape.js")),T=i.n(M),E={selector:"examBuildConsole",template:i("./src/app/exam/build/build-console/build-console.component.html"),styles:[i("./src/app/exam/build/build-console/build-console.component.less")],bindings:{build:"<"},controller:(P.$inject=["$element","$sce","$scope","$timeout"],P.prototype.$onInit=function(){var i=this;this.$scope.$watch(function(){var e;return i.build&&(null===(e=i.build.result)||void 0===e?void 0:e.consoleOutput)},function(){var e=i.build;if(e&&!e.isInProgress()){var t=i.renderConsoleOutput(e.result.consoleOutput);i.logHtml=i.$sce.trustAsHtml(t),i.scrollToConsoleEnd()}else i.logHtml=void 0})},P.prototype.renderConsoleOutput=function(e){var t="";return String(e||"").trim().split("\n").forEach(function(e){(e=T()(e)).includes("ERROR")||e.includes("FAILURE")||e.includes("FAILED")?t+='<span class="color-danger">'+e+"</span>\n":e.includes("WARNING")?t+='<span class="color-warning">'+e+"</span>\n":e.includes("SUCCESS")?t+='<span class="color-success">'+e+"</span>\n":t+=e+"\n"}),t+='<span class="console-log-end-marker"></span>'},P.prototype.scrollToConsoleEnd=function(){var t=this;this.$timeout(function(){var e=t.$element;e.find(".console-log-end-marker").each(function(){e.scrollToElementAnimated(this)})},200)},P)};function P(e,t,i,n){this.$element=e,this.$sce=t,this.$scope=i,this.$timeout=n}var I={selector:"examBuildConsoleLoader",template:i("./src/app/exam/build/build-console-loader/build-console-loader.component.html"),styles:[i("./src/app/exam/build/build-console-loader/build-console-loader.component.less")],controller:(A.$inject=["$element"],A)};function A(e){e.addClass(e[0].tagName.toLowerCase())}var B=l.module("exam.build.buildConsoleLoader",[]).component(I.selector,I).name,j=l.module("exam.build.buildConsole",[B]).component(E.selector,E).name,O=i("./node_modules/lodash/sortBy.js"),_=i.n(O),R=(D.prototype.isSuccess=function(){return this.result&&"SUCCESS"===this.result.buildStatus},D.prototype.isFailure=function(){return this.result&&["FAILURE","INTERNAL_ERROR","TIMEOUT"].includes(this.result.buildStatus)},D.prototype.isTestFailure=function(){return this.result&&"TEST_FAILURE"===this.result.buildStatus},D.prototype.isInProgress=function(){return!this.result||!this.result.buildStatus},D.prototype.getSqlTestResult=function(){var e=this.result.sqlResults;return Array.isArray(e)&&0<e.length?e.find(function(e){return"CandidateTestCase"===e.testCaseName}):null},D.prototype.isSqlQueryError=function(){var e=this.getSqlTestResult();return e&&e.errorMessage&&0<=e.errorMessage.indexOf("Failed to execute query")},D.prototype.getSqlErrorMessage=function(){var e=this.getSqlTestResult(),t="";return e&&e.errorMessage&&(t=(t=e.errorMessage)&&(t=t.replace(/Failed to execute query: [\w]*;\s/,"")).replace(/; nested exception is [\w\.]*:/," ")),t},D.prototype.getSqlQueryResult=function(){var e=this.getSqlTestResult();return e&&e.queryResult&&0<e.queryResult.length?e.queryResult:null},D.prototype.getSqlExpectedResult=function(){var e=this.getSqlTestResult();return e&&e.expectedResult&&0<e.expectedResult.length?e.expectedResult:null},D);function D(e){this.index=e,this.result={},this.startedAt=Date.now()}var q=(L.$inject=["$q","$rootScope","$timeout","examService","FileService","firebaseService","logger"],L.prototype.initListeners=function(){var i=this;this.$rootScope.$on("buildCurrentProject",function(e,t){i.buildProject(null==t?void 0:t.saveAll)}),this.$rootScope.$on("notification_EXAM_BUILD_RESULT",function(e,t){i.logger.info("Received notification EXAM_BUILD_RESULT "+i.debugBuildResult(t)),i.processBuildResult(t),i.firebaseService.addPageActivity({type:L.EVENT_BUILD_RECEIVED,buildResult:JSON.stringify(t)})}),this.firebaseService.registerOnValue("activities","child_added",function(e){if(e.type===L.EVENT_BUILD_RECEIVED){var t=void 0;try{t=JSON.parse(e.buildResult)}catch(e){}t&&(i.logger.info("Received build result from firebaseService "+i.debugBuildResult(t)),i.processBuildResult(t))}})},L.prototype.debugBuildResult=function(e){var t,i,n;return e?"{ "+["buildStatus: "+(null==e?void 0:e.buildStatus),"consoleOutput: String("+((null===(t=null==e?void 0:e.consoleOutput)||void 0===t?void 0:t.length)||0)+")","details: Array("+(null===(i=null==e?void 0:e.details)||void 0===i?void 0:i.length)+")","sqlResults: Array("+(null===(n=null==e?void 0:e.sqlResults)||void 0===n?void 0:n.length)+")"].join(", ")+" }":"(empty)"},L.prototype.createBuild=function(){return new R(++this.buildsCount)},L.prototype.createTestClass=function(t,e){var i={name:t,fileHash:null,methods:[],failedCount:0};return e.forEach(function(e){e.className===t&&(i.fileHash||(i.fileHash=e.fileHash),i.methods.push({name:e.testMethod||"N/A",message:e.message,failed:"FAIL"===e.type}),"FAIL"===e.type&&(i.failedCount+=1))}),i.methods=_()(i.methods,function(e){return(e.failed?"0":"1")+e.name}),i},L.prototype.getLastBuild=function(){var e=this.builds;return e.length?e[0]:null},L.prototype.processBuildResult=function(e){var i=this,t=this.$timeout,n=this.builds,o=this.logger;o.debug("Processing build result"),0===n.length&&this._createNewBuild();var s=this.getLastBuild();if(s)if(this.buildInProgress){s.monitor&&(o.info("Cancelled build monitor"),t.cancel(s.monitor));var r=null;if(s.startedAt&&(r=Date.now()-s.startedAt),o.info("Received build "+s.index+" result after "+r+" ms"),s.result=e,this.buildInProgress=null,s.result&&Array.isArray(s.result.details)){var a=s.result;a.passedTestsCount=0,a.failedTestsCount=0,a.totalTestsCount=0,a.testClasses=[],a.details.forEach(function(t){t.type&&(t.className&&!a.testClasses.find(function(e){return e.name===t.className})&&a.testClasses.push(i.createTestClass(t.className,a.details)),"FAIL"===t.type?a.failedTestsCount++:a.passedTestsCount++,a.totalTestsCount++)}),a.testClasses=_()(a.testClasses,function(e){return-1*e.failedCount})}this.$rootScope.$broadcast(L.EVENT_BUILD_RECEIVED,s)}else o.warn("There is no build in progress, skipping build result")},L.prototype.isBuildInProgress=function(){return Boolean(this.buildInProgress)},L.prototype.removeBuild=function(e){this.builds.splice(this.builds.indexOf(e),1)},L.prototype.clearBuilds=function(){this.builds.length=0,this.buildsCount=0},L.prototype.getBuilds=function(){return this.builds},L.prototype.internalErrorHandler=function(e,t){e&&(e.result={buildStatus:"INTERNAL_ERROR",consoleOutput:"FAILURE: Internal build error: "+t.status+"/"+t.statusText,details:t}),this.buildInProgress=null,this.logger.error("Setting INTERNAL_ERROR for build, FAILURE: Internal build error: "+t.status+"/"+t.statusText)},L.prototype._createNewBuild=function(){var e=this.createBuild();return this.builds.unshift(e),this.buildInProgress=e},L.prototype._appendToConsoleOutput=function(e){var t=this.buildInProgress;t&&t.result&&t.result.consoleOutput&&(t.result.consoleOutput+=e)},L.prototype._doBuild=function(e){var t=this,i=this.$timeout,n=this.examService,o=this.firebaseService,s=this.logger,r=this.buildInProgress,a=this.builds.length,l=n.getCurrentPageNumber();s.info("Requesting new build for "+l+": "+a+", quickBuild: "+e),n.buildProject(e).then(function(){o.addPageActivity({type:"buildRequested"}),i(function(){t._appendToConsoleOutput("Setting up database...")},200),i(function(){t._appendToConsoleOutput("OK\nInitializing schema...")},2e3),i(function(){t._appendToConsoleOutput("OK\nRunning query...\n")},4e3);var e=2e4;n.areWebsocketsWorking()?s.warn("No build result after 20 seconds for "+l+": "+a+", monitoring build..."):(s.warn("Websockets are not working, starting build monitoring immediately"),e=1e3),r&&(r.monitor=i(function(){n.monitorLastBuildForPage(l).then(function(e){e.data&&200===e.status&&t.processBuildResult(e.data)})},e))},function(e){t.internalErrorHandler(t.buildInProgress,e)})},L.prototype.quickBuildProject=function(){this.buildProject(!1,!0)},L.prototype.buildProject=function(e,t){var i=this;if(!this.examService.isSpectator()){var n=this.FileService;if(!this.buildInProgress){var o=this._createNewBuild(),s=n.getModifiedFiles(),r=this.$q;return s.length?e?(o.result.consoleOutput="Saving modified files...",r.all(s.map(function(e){return n.saveFile(e.hash)})).then(function(){return o.result.consoleOutput+="OK\n",i._doBuild(t)})):n.checkForModifiedFiles().then(function(){return i._doBuild()},function(){i.buildInProgress=null,i.builds.splice(0,1)}):(o.result.consoleOutput="",this._doBuild(t))}}},L.prototype.fetchLastBuild=function(){var t=this;this.examService.lastBuild().then(function(e){200===e.status&&t.processBuildResult(e.data)})},L.prototype.connectToFirepad=function(){var i=this,n=this.$timeout,o=this.examService,e=this.firebaseService,s=!1;o.isSpectator()&&(e.registerOnValue("activities","child_added",function(e){if(!s)return!1;if("buildRequested"===e.type){var t=i._createNewBuild();t.monitor=n(function(){t&&o.monitorLastBuild().then(function(e){e.data&&200===e.status&&i.processBuildResult(e.data)})},2e4)}}),e.registerOnceValue("activities","value",function(){s=!0}))},L.prototype.unselectBuild=function(){throw new Error("BuildService#unselectBuild() is not implemented")},L.prototype.getSelectedBuild=function(){throw new Error("BuildService#getSelectedBuild() is not implemented")},L.EVENT_BUILD_RECEIVED="buildService.buildReceived",L);function L(e,t,i,n,o,s,r){this.$q=e,this.$rootScope=t,this.$timeout=i,this.examService=n,this.FileService=o,this.firebaseService=s,this.logger=r,this.builds=[],this.buildsCount=0,this.initListeners()}var H=l.module("exam.build.buildService",[]).service("buildService",q).name,N={selector:"buildDetails",template:i("./src/app/exam/build/build-details.component.html"),styles:[i("./src/app/exam/build/build-details.component.less")],controller:(z.$inject=["$scope","buildService","FileService"],z.prototype.$onInit=function(){this.refreshBuild(),this.$scope.$on(q.EVENT_BUILD_RECEIVED,this.refreshBuild)},z.prototype.refreshBuild=function(){this.build=this.buildService.getLastBuild(),this.activeTestClassName="",this.activeTestMethod=null,this.setupDefaultTestSelection()},z.prototype.setupDefaultTestSelection=function(){if(this.build&&this.build.result&&this.build.result.testClasses&&0<this.build.result.testClasses.length){var e=this.build.result.testClasses[0];this.activeTestClassName=e.name;var t=e.methods.find(function(e){return e.failed});t&&(this.activeTestMethod=t)}},z.prototype.isTestClassActive=function(e){return e.name===this.activeTestClassName},z.prototype.isTestMethodActive=function(e,t){return this.isTestClassActive(e)&&this.activeTestMethod===t},z.prototype.toggleTestClass=function(e){this.activeTestClassName===e.name?this.activeTestClassName="":this.activeTestClassName=e.name},z.prototype.activateTestMethod=function(e,t,i){i.preventDefault(),i.stopPropagation(),this.activeTestMethod=t},z.prototype.getFileName=function(e){return e?this.FileService.getFileName(e):""},z.prototype.goTo=function(e){e.fileHash&&this.FileService.openFile(e.fileHash,e.line)},z.prototype.isBuildVisible=function(){return Boolean(this.buildService.getLastBuild())},z)};function z(e,t,i){this.$scope=e,this.buildService=t,this.FileService=i,this.activeTestClassName="",this.activeTestMethod=null,this.refreshBuild=this.refreshBuild.bind(this)}var W={selector:"buildPanel",template:i("./src/app/exam/build/build-panel.component.html"),styles:[i("./src/app/exam/build/build-panel.component.less")],bindings:{task:"<",tabs:"<",lastBuild:"<"},controller:(U.$inject=["$rootScope","$scope","buildService","dialogs","hotkeys","logger","runtimeInfoService"],U.prototype.$onInit=function(){var e=this,t=this,i=t.$rootScope,n=t.$scope,o=t.buildService,s=t.dialogs,r=t.logger,a=t.hotkeys;r.debug("Initializing buildPanel controller, fetching last build"),c.A[this.task.projectType]!==c.A.PLAIN&&this.buildService.fetchLastBuild(),a.add({combo:"f9",description:"Build project",callback:function(){i.$broadcast("buildCurrentProject")}}),n.$on("buildCurrentProject",function(){e.task.compilable?e.tabs.show("build-console"):s.notify("Cannot build project","Current project type is not eligible for build.")}),o.getBuilds()},U.prototype.$onChanges=function(e){e.lastBuild&&this.onLastBuildChange()},U.prototype.$onDestroy=function(){this.hotkeys.del("f9")},U.prototype.onLastBuildChange=function(){var e=this.lastBuild,t="build-console";this.task.singleFileMode&&this.lastBuild&&(this.lastBuild.isInProgress()?t="build-console":this.lastBuild.isFailure()||(t="test-results")),this.tabs.show(t),e&&!e.isInProgress()&&this.task.singleFileMode&&!e.isFailure()&&this.tabs.show("test-results")},U.prototype.isQuickBuildSupported=function(){return this.runtimeInfoService.isQuickBuildSupported(this.task.projectType,this.task.projectTypeVersion)},U.prototype.quickBuildProject=function(){this.tabs.show("build-console"),this.buildService.quickBuildProject()},U.prototype.buildProject=function(){this.tabs.show("build-console"),this.buildService.buildProject()},U)};function U(e,t,i,n,o,s,r){this.$rootScope=e,this.$scope=t,this.buildService=i,this.dialogs=n,this.hotkeys=o,this.logger=s,this.runtimeInfoService=r}var V=i("./src/app/exam/build/build-project-button.directive.html"),G=(Q.$inject=["buildService","runtimeInfoService","$element"],Q.prototype.buildProject=function(){return this.tab&&this.tabs&&this.tabs.show(this.tab),this.quickBuild?this.buildService.quickBuildProject():this.buildService.buildProject()},Q.prototype.isBuildInProgress=function(){return this.buildService.isBuildInProgress()},Q.prototype.isQuickBuildSupported=function(){return this.runtimeInfoService.isQuickBuildSupported(this.task.projectType,this.task.projectTypeVersion)},Q.prototype.isTooltipEnabled=function(){return!0},Q);function Q(e,t,i){this.buildService=e,this.runtimeInfoService=t,this.tooltip="Build project (F9)"}var Y=(Z.$inject=["$compile"],Z.prototype.compile=function(e,s){var i=this,r=["ngIf","ngRepeat","ngSwitch",Z.selector];return e.each(function(e,t){for(var i=0,n=Array.from(t.attributes);i<n.length;i++){var o=n[i];r.includes(s.$normalize(o.name))&&t.removeAttribute(o.name)}}),e.attr("ng-click","$ctrl.buildProject($event)"),e.attr("ng-show","$ctrl.task.compilable"),e.attr("ng-disabled","$ctrl.isBuildInProgress()"),e.attr("uib-tooltip","{{ $ctrl.tooltip }}"),e.attr("tooltip-enable","$ctrl.isTooltipEnabled()"),e.attr("tooltip-append-to-body","true"),e.is("button")?e.attr("type","button"):e.attr("role","button"),e.addClass("build-project-button"),function(e,t){i.$compile(t)(e)}},Z.selector="buildProjectButton",Z);function Z(e){this.$compile=e,this.restrict="A",this.priority=599,this.terminal=!0,this.template=V,this.bindToController={task:"<",quickBuild:"<",tabs:"<",tab:"@"},this.controllerAs="$ctrl",this.controller=G,this.scope={}}var K=i("./src/common/directive-factory.ts"),J={selector:"examSqlBuildPanel",template:i("./src/app/exam/build/sql-build-panel/sql-build-panel.component.html"),bindings:{task:"<",lastBuild:"<"},controller:(X.$inject=["$rootScope","logger"],X.prototype.buildProject=function(){this.logger.debug("[sqlBuildPanel] Triggering build for SQL Project..."),this.$rootScope.$broadcast("buildCurrentProject",{saveAll:!0})},X)};function X(e,t){this.$rootScope=e,this.logger=t}var ee=l.module("exam.build.sqlBuildPanel",[B,H]).component(J.selector,J).name,te=l.module("exam.build",["cfp.hotkeys",j,H,ee]).directive(Y.selector,Object(K.a)(Y)).component(W.selector,W).component(N.selector,N).name,ie=i("./src/app/exam/editor/exam-code-editor.ts"),ne={selector:"autocompleteOff",restrict:"A",controller:(oe.$inject=["$element"],oe.prototype.$onInit=function(){this.$element.attr("autocomplete",this.id),this.$element.on("focus",this.onFocus).on("blur",this.onBlur)},oe.prototype.$onDestroy=function(){this.$element.off("focus",this.onFocus).off("blur",this.onBlur)},oe)};function oe(e){var t=this;this.$element=e,this.id=Math.random().toString(36).substr(2),this.onFocus=function(){var e=t.$element;t.name=e.attr("name"),e.attr("name",t.id)},this.onBlur=function(){t.$element.attr("name",t.name)}}var se=l.module("dvsk.autocompleteOff",[]).directive(ne.selector,Object(K.a)(ne)).name,re={selector:"confirmCloseModifiedFile",template:i("./src/app/exam/editor/confirm-close-modified-file.component.html"),bindings:{hash:"<",file:"<",close:"&",dismiss:"&"},controller:(ae.$inject=["FileService"],ae.prototype.saveFile=function(){var e=this.FileService,t=this.hash;return e.saveFile(t).then(function(){e.closeFile(t)})},ae.prototype.revertFile=function(){return this.FileService.revertFile(this.hash)},ae)};function ae(e){this.FileService=e}var le=i("./node_modules/lodash/difference.js"),ce=i.n(le),de=i("./node_modules/lodash/filter.js"),ue=i.n(de),pe=i("./node_modules/lodash/find.js"),he=i.n(pe),me=i("./node_modules/lodash/forEach.js"),fe=i.n(me),ve=i("./node_modules/lodash/includes.js"),ge=i.n(ve),be=i("./node_modules/lodash/isEmpty.js"),ye=i.n(be),$e=i("./node_modules/lodash/isUndefined.js"),Se=i.n($e),we=i("./node_modules/lodash/keys.js"),ke=i.n(we),Ce=i("./node_modules/lodash/last.js"),xe=i.n(Ce),Fe=i("./node_modules/lodash/map.js"),Me=i.n(Fe),Te=i("./node_modules/lodash/now.js"),Ee=i.n(Te),Pe=i("./node_modules/lodash/remove.js"),Ie=i.n(Pe),Ae=i("./node_modules/lodash/uniqueId.js"),Be=i.n(Ae),je=i("./node_modules/lodash/values.js"),Oe=i.n(je),_e={selector:"modifiedFilesModal",template:i("./src/app/exam/files/modified-files-modal.component.html"),bindings:{modifiedFiles:"<",close:"&",dismiss:"&"},controller:(Re.$inject=["$q","FileService"],Re.prototype.$onInit=function(){},Re.prototype.saveFiles=function(){var t=this;return this.$q.all(this.modifiedFiles.map(function(e){return t.FileService.saveFile(e.hash)}))},Re.prototype.revertFiles=function(){var t=this;return this.$q.all(this.modifiedFiles.map(function(e){return t.FileService.revertFile(e.hash)}))},Re)};function Re(e,t){this.$q=e,this.FileService=t}var De=(qe.$inject=["$q","$rootScope","base64","dialogs","examService","firebaseService","logger"],qe.prototype.createFileHandle=function(e,t,i,n,o){return{hash:e,name:t,type:i,parentHash:n||void 0,childrenHashes:[],attributes:o||{},content:void 0,contentType:void 0,lastModification:void 0,lastSave:void 0,loadInProgress:!1,setContent:function(e,t){this.content!==e&&(Se()(this.content)||(this.lastModification=Ee()()),(this.content=e)&&t?this.contentType=t:Se()(e)&&(this.contentType=void 0))},isModified:function(){return Boolean(this.lastModification)&&(!this.lastSave||this.lastSave<this.lastModification)}}},qe.prototype.makeTreeNode=function(e){var t=this,i=e.name;e.attributes&&(e.attributes.hidden?i+=' <i class="file-node-hidden">[Hidden]</i>':e.attributes.readOnly?i+=' <i class="file-node-read-only">[Read only]</i>':e.attributes.verificationTest&&(i+=' <i class="file-node-verification-test">[Verification test]</i>'));var n={id:Be()("file_"),hash:e.hash,text:i,type:e.type,a_attr:{filehash:encodeURIComponent(e.hash)}};if(e.childrenHashes&&(n.children=Me()(e.childrenHashes,function(e){return t.makeTreeNode(t.files[e])}),e.hash&&"ROOT_FILE"!==e.hash)){var o=this.base64.decode(e.hash);o&&("src"===o||0<=o.indexOf("src/main"))&&(n.state={opened:!0})}return n},qe.prototype.setSaveInProgress=function(){this.saveInProgress=!0},qe.prototype.finishSaveInProgress=function(){this.saveInProgress=!1},qe.prototype.isSaveInProgress=function(){return this.saveInProgress},qe.prototype.setFiles=function(e){var i=this;e&&this.logger.debug("Setting "+e.length+" task files");var n=function(e,t){fe()(e,function(e){i.files[e.hash]=i.createFileHandle(e.hash,e.name,e.type,t,e.fileAttributes),ye()(e.files)||(i.files[e.hash].childrenHashes=Me()(e.files,"hash"),n(e.files,e.hash))})};this.files=Object.create(null),this.openedFiles.length=0,this.activeContext.clear(),n(e);var t=he()(e,function(e){return".editorconfig"===e.name});this.editorConfigHash=t?t.hash:null},qe.prototype._openFile=function(e,t){var i=this.activeContext,n=this.files[e];return n&&"directory"!==n.type.toLowerCase()&&(ge()(this.openedFiles,n)||(this.openedFiles.push(n),this.getFileContent(n.hash)),i.file=n,i.line=t||0),i},qe.prototype.openFile=function(e,t){var i=this._openFile(e,t);this.firebaseService.setCodeEditorContext(this.openedFiles,i)},qe.prototype.openMultipleFiles=function(e,i){var n=this;i=i||xe()(e),fe()(e,function(e){var t=n.files[e];t&&"directory"!==t.type.toLowerCase()&&(ge()(n.openedFiles,t)||(n.openedFiles.push(t),n.getFileContent(t.hash),i===e&&(n.activeContext.file=t,n.activeContext.line=void 0)))})},qe.prototype.getFileContent=function(e){var i=this.files[e];if(!i)return this.$q.reject();if("string"==typeof i.content)return this.$q.resolve(i.content);if(!i.contentPromise){var n=this.base64,t=this.examService;i.loadInProgress=!0,i.contentPromise=t.getFile(e).then(function(e){var t=e.data;return i.setContent(n.decode(t.encodedContents),t.mimeType),i.content||""},function(e){throw e}).finally(function(){i.loadInProgress=!1})}return i.contentPromise},qe.prototype._createFile=function(e,t,i,n){if(this.files[e]=this.createFileHandle(e,t,i?"DIRECTORY":"FILE",n),n&&this.files[n]){var o=this.files[n];o.childrenHashes=o.childrenHashes||[],o.childrenHashes.push(e)}return this.files[e]},qe.prototype._createFilePath=function(e,t){return(e+"/"+t).replace(/\/+/g,"/").replace(/^\/+/,"")},qe.prototype.optimisticCreateFile=function(e,i,n,o){var s=this,r=this._createFilePath(e,i),a=btoa(r);if(this.files[a])return this.dialogs.error("Create file failed","Another file with this name already exists at the requested path"),this.$q.reject();var l=this._createFile(a,i,o,n),c=l.type;return l.setContent(""),this.firebaseService.updateChildValue("newFile",{hash:a,name:i,type:c,parentHash:n}),this.openFile(a),this.examService.createFile(r,o).then(function(e){if(e&&e===a)return l;if(s._deleteFile(a),s.firebaseService.updateChildValue("deleteFile",{hash:a}),e){var t=s._createFile(e,i,o,n);return t.setContent(l.content),s.firebaseService.updateChildValue("newFile",{hash:e,name:i,type:c,parentHash:n}),s.openFile(t.hash),s.logger.error("FileService: File hash mismatch: path="+r+", expected="+a+", received="+e),t}return null})},qe.prototype.createFile=function(e,i,n,o){var s=this,t=this.examService,r=this._createFilePath(e,i);return t.createFile(r,o).then(function(e){if(!e)return null;var t=s._createFile(e,i,o,n);return s.firebaseService.updateChildValue("newFile",{hash:e,name:name,type:t.type,parentHash:n}),s.openFile(t.hash),t})},qe.prototype.saveFile=function(e){var t=this,i=this.$q,n=this.examService,o=this.files[e];return o&&"directory"!==o.type.toLowerCase()?(this.setSaveInProgress(),n.saveFile(e,o.content).then(function(){o.lastSave=+new Date,t.firebaseService.updateChildValue("saveFile",{hash:e,lastSave:o.lastSave,lastModification:o.lastModification})}).finally(function(){t.finishSaveInProgress()})):i.reject("File not found")},qe.prototype.refreshFiles=function(){var t=this;this.examService.getCurrentPage().then(function(e){t.setFiles(e.data.tasks[0].files)})},qe.prototype.synchronizeFiles=function(){var t=this,e=this.examService,i=this.firebaseService;return e.synchronizeCurrentRepo().then(function(e){if(i.isEnabled())return i.clearFilesContent(t.getFileHashes()).then(function(){t.setFiles(e.tasks[0].files)});t.setFiles(e.tasks[0].files)})},qe.prototype.deleteFile=function(i){var n=this;return this.examService.deleteFile(i).then(function(){var e=n._deleteFile(i),t=n.firebaseService;t.setCodeEditorContext(n.openedFiles,n.activeContext),e.forEach(function(e){t.updateChildValue("deleteFile",{hash:e})})})},qe.prototype._deleteFile=function(e){return this._deleteFileTree(e,[])},qe.prototype._deleteFileTree=function(t,i){var n=this,e=this.files[t];if(!e)return i;if(Array.isArray(e.childrenHashes)&&e.childrenHashes.slice().forEach(function(e){n._deleteFileTree(e,i)}),e.parentHash){var o=this.files[e.parentHash];o&&Array.isArray(o.childrenHashes)&&Ie()(o.childrenHashes,function(e){return t===e})}return this._closeFile(t),delete this.files[t],i.push(t),i},qe.prototype.revertFile=function(e){var t=this.examService,i=this.base64,n=this.$rootScope,o=this.files[e];return o&&"directory"!==o.type.toLowerCase()?t.getFile(e).then(function(e){var t=e.data;o.setContent(i.decode(t.encodedContents),t.mimeType),o.lastModification=void 0,o.lastSave=void 0,n.$broadcast("revertedFileContent",o)}):this.$q.reject("File "+o+" not found")},qe.prototype._closeFile=function(e){var t=this.files[e];if(t){var i,n=this.openedFiles.indexOf(t);-1!==n&&(i=0===n?this.openedFiles[1]:this.openedFiles[n-1],this.openedFiles.splice(n,1)),this.activeContext.file===t&&(i?(this.activeContext.file=i,this.activeContext.line=null):this.activeContext.clear())}},qe.prototype.closeFile=function(e){var t=this.firebaseService;this._closeFile(e),t.isEnabled()&&t.setCodeEditorContext(this.openedFiles,this.activeContext)},qe.prototype.connectPageWithFirebase=function(){var i=this,e=this.firebaseService;e.isEnabled()&&(e.listenToChildValueChanges("codeEditorContext",function(e){var t=i.getOpenedFiles().map(function(e){return e.hash});e&&(ce()(t,e.openedFiles).forEach(function(e){i._closeFile(e)}),i.getActiveFileHash()!==e.activeContextFile&&i._openFile(e.activeContextFile))}),e.initCodeEditorContext(function(e){e&&i.openMultipleFiles(e.openedFiles,e.activeContextFile)}),e.listenToChildValueChanges("newFile",function(e){i.files[e.hash]||(i.files[e.hash]=i.createFileHandle(e.hash,e.name,e.type,e.parentHash))}),e.listenToChildValueChanges("deleteFile",function(e){i._deleteFile(e.hash)}),e.listenToChildValueChanges("saveFile",function(e){var t=i.files[e.hash];t&&(t.lastSave=e.lastSave,t.lastModification=e.lastModification)}))},qe.prototype.isActive=function(e){var t;return(null===(t=this.activeContext.file)||void 0===t?void 0:t.hash)===e},qe.prototype.setActive=function(e){if(e){if(!this.files[e])throw Error("File "+e+" is not found");this.activeContext.file=this.files[e],this.activeContext.line=null,this.firebaseService.isEnabled()&&this.firebaseService.setCodeEditorContext(this.openedFiles,this.activeContext)}else this.activeContext.clear()},qe.prototype.getActiveContext=function(){return this.activeContext},qe.prototype.getActiveFile=function(){return this.activeContext.file},qe.prototype.getActiveFileHash=function(){var e=this.getActiveContext();return e.file?e.file.hash:null},qe.prototype.revertActiveFile=function(){var e=this.getActiveFile();if(e)return this.revertFile(e.hash);this.$q.reject("There is no active file!")},qe.prototype.saveActiveFile=function(){var e=this.getActiveFile();return e?this.saveFile(e.hash):this.$q.reject("There is no active file!")},qe.prototype.isActiveFileModified=function(){var e;return null===(e=this.getActiveFile())||void 0===e?void 0:e.isModified()},qe.prototype.setFileContent=function(e,t){this.files[e].setContent(t)},qe.prototype.isModified=function(e){return this.files[e]&&this.files[e].isModified()},qe.prototype.getFileName=function(e){return this.getFile(e).name},qe.prototype.getFile=function(e){if(this.files[e])return this.files[e];throw Error("File not found: "+e)},qe.prototype.getFiles=function(){return Oe()(this.files)},qe.prototype.getFileHashes=function(){return ke()(this.files)},qe.prototype.getOpenedFiles=function(){return this.openedFiles},qe.prototype.getModifiedFiles=function(){return Object.values(this.files).filter(function(e){return e.isModified()})},qe.prototype.isOpened=function(e){return!Se()(this.files[e])},qe.prototype.fileExists=function(e){return!Se()(this.files[e])},qe.prototype.getParentHash=function(e){if(this.files[e])return this.files[e].parentHash;throw Error("File not found")},qe.prototype.getEditorConfig=function(){return this.getFileContent(this.editorConfigHash)},qe.prototype.getJstreeNode=function(e){return this.files[e]?this.makeTreeNode(this.files[e]):null},qe.prototype.getJstreeModel=function(){var e=Oe()(this.files),t=Me()(ue()(e,{parentHash:void 0}),"hash"),i=this.makeTreeNode({hash:"ROOT_FILE",name:"Root",childrenHashes:t}),n=i.children;if(n.length<5&&fe()(n,function(e){e.state={opened:!0}}),e.length<25){var o=function(e){e.children&&(e.state={opened:!0},fe()(e.children,o))};o(i)}return n},qe.prototype.checkForModifiedFiles=function(){var e=this.$q,t=this.dialogs,i=this.getModifiedFiles();return i.length?t.open({component:_e.selector,size:"lg",keyboard:!0,backdrop:"static",windowClass:"colored-header",resolve:{modifiedFiles:function(){return i}}}).result:e.resolve()},qe);function qe(e,t,i,n,o,s,r){this.$q=e,this.$rootScope=t,this.base64=i,this.dialogs=n,this.examService=o,this.firebaseService=s,this.logger=r,this.files=Object.create(null),this.openedFiles=[],this.saveInProgress=!1,this.activeContext={file:null,line:null,clear:function(){this.file=null,this.line=null}}}var Le=i("./src/app/exam/files/exam-file-tree.ts"),He=l.module("exam.files",[Le.a,se]).service("examFileService",De).factory("FileService",["$injector",function(e){return e.get("examFileService")}]).component(_e.selector,_e).component(re.selector,re).name,Ne={selector:"excelMode",template:i("./src/app/exam/steps/code-edit/excel-mode/excel-mode.component.html"),bindings:{task:"<"},controller:(ze.prototype.$onInit=function(){},ze)};function ze(){}var We={selector:"gitMode",template:i("./src/app/exam/steps/code-edit/git-mode.component.html"),bindings:{task:"<"},controller:(Ue.prototype.$onInit=function(){this.clone={command:this.task.repositoryUrl+""},this.readOnlyPatterns=[],this.task.readOnlyPatterns&&0<this.task.readOnlyPatterns.length&&(this.readOnlyPatterns=this.task.readOnlyPatterns.filter(function(e){return"devskiller.json"!==e}))},Ue.prototype.hasReadOnlyPatterns=function(){return 0<this.readOnlyPatterns.length},Ue.prototype.joinedReadOnlyPatterns=function(){return this.readOnlyPatterns.join("\n")},Ue)};function Ue(){}var Ve=(Ge.prototype.calculateSidebarWidth=function(){var e=this.panelsContainer.width(),t=350;return this.layout.descriptionAtSidebar&&(t=400,e&&e<t&&(t=Math.ceil(.4*e))),t},Ge.prototype.setLayout=function(e){this.layout=e,this.sidebarWidth=this.calculateSidebarWidth(),this.sidebarCollapseInfo={left:0,width:this.sidebarWidth},this.buildPanelCollapseInfo={bottom:0,mainContentHeight:0,buildPanelTop:0,buildPanelHeight:0},this.updateLayoutForCodingMode()},Ge.prototype.dispose=function(){},Ge.prototype.buildPanelDiv=function(){return this.panelsContainer.children(".build-panel-wrapper")},Ge.prototype.mainContentDiv=function(){return this.panelsContainer.children(".main-content")},Ge.prototype.leftSidebar=function(){return this.panelsContainer.children(".left-sidebar")},Ge.prototype.isMainPanelExpanded=function(){return this.buildPanelCollapsed&&this.sidebarCollapsed},Ge.prototype.expandMainPanel=function(){this.buildPanelCollapsed||this.collapseBuildPanel(),this.sidebarCollapsed||this.collapseSidebar()},Ge.prototype.compressMainPanel=function(){this.buildPanelCollapsed&&this.showBuildPanel(),this.sidebarCollapsed&&this.showSidebar()},Ge.prototype.collapseBuildPanel=function(){this.buildPanelCollapsed=!0;var e=this.buildPanelDiv(),t=this.mainContentDiv();this.buildPanelCollapseInfo.buildPanelHeight=e.css("height"),this.buildPanelCollapseInfo.buildPanelTop=e.css("top"),this.buildPanelCollapseInfo.bottom=t.css("bottom"),this.buildPanelCollapseInfo.mainContentHeight=t.css("height"),e.css({height:"30px",top:"auto",bottom:0}),t.css({bottom:"30px",height:"auto"}),e.addClass("collapsed"),t.addClass("build-panel-collapsed")},Ge.prototype.showBuildPanel=function(e){this.buildPanelCollapsed=!1;var t=this.buildPanelDiv(),i=this.mainContentDiv(),n=this.buildPanelCollapseInfo;t.css({height:n.buildPanelHeight,top:"auto",bottom:0}),i.css({bottom:n.bottom,height:n.mainContentHeight}),t.removeClass("collapsed"),i.removeClass("build-panel-collapsed"),e&&this.tabs.show(e)},Ge.prototype.toggleBuildPanel=function(e){this.buildPanelCollapsed?this.showBuildPanel(e):this.collapseBuildPanel()},Ge.prototype.collapseSidebar=function(){var e=this;this.sidebarCollapsed=!0,this.sidebarCollapseInfo.left=parseInt(this.mainContentDiv().css("left"),10),this.sidebarCollapseInfo.width=parseInt(this.leftSidebar().css("width"),10),this.leftSidebar().css({width:"30px"}),this.mainContentDiv().css({left:"40px"}),this.buildPanelDiv().css({left:"40px"}),this.$timeout(function(){e.leftSidebar().addClass("collapsed")},100)},Ge.prototype.showSidebar=function(){var e=this.sidebarCollapseInfo;this.sidebarCollapsed=!1,this.leftSidebar().removeClass("collapsed"),this.updateSidebarWidth(e.width)},Ge.prototype.toggleSidebar=function(){this.sidebarCollapsed?this.showSidebar():this.collapseSidebar()},Ge.prototype.updateLayoutForCodingMode=function(){this.panelsContainer.width()<992?(this.leftSidebar().addClass("collapsed"),this.collapseSidebar()):this.showSidebar()},Ge.prototype.updateLayoutWhileResizing=function(e){var t=this.mainContentDiv();if("left-sidebar"===e.id&&this.updateSidebarWidth(e.width),"right-sidebar"===e.id){var i={right:e.width};t.css(i),this.buildPanelDiv().css(i)}"main-panel"===e.id&&this.buildPanelDiv().css({top:e.height,height:t.parent().height()-e.height})},Ge.prototype.updateSidebarWidth=function(e){this.sidebarCollapseInfo.width=e,this.mainContentDiv().css({left:e}),this.buildPanelDiv().css({left:e}),this.leftSidebar().css({width:e})},Ge);function Ge(e,t,i,n){this.panelsContainer=e,this.tabs=i,this.$timeout=n,this.panelsContainer=e,this.sidebarCollapsed=!1,this.buildPanelCollapsed=!1,this.setLayout(t)}var Qe={selector:"programmingTaskEditor",template:i("./src/app/exam/steps/code-edit/programming-task-editor.component.html"),styles:[i("./src/app/exam/steps/code-edit/programming-task-editor.component.less")],bindings:{task:"<",layout:"<",codingMode:"<",inOvertimeMode:"<",switchToGitMode:"&",switchToDownloadMode:"&",switchToProgrammingMode:"&",refreshProject:"&"},controller:(Ye.$inject=["$element","$rootScope","$scope","$timeout","buildService","examService","FileService","runtimeInfoService"],Ye.prototype.$onInit=function(){var i=this,e=this.$scope,t=this.$rootScope,n=this.buildService;e.$watch(function(){return n.getBuilds().length},function(){i.lastBuild=n.getLastBuild()}),e.$on("angular-resizable.resizing",function(e,t){i.layoutManager&&i.layoutManager.updateLayoutWhileResizing(t)}),e.$on("angular-resizable.resizeEnd",function(){t.$broadcast("refreshEditor")}),this.buildService.clearBuilds(),this.buildService.connectToFirepad(),this.activeSidebarTab="fileTree",this.FileService.setFiles(this.task.files),this.FileService.connectPageWithFirebase(),this.layoutManager=new Ve(this.panelsContainer(),this.layout,this.tabs,this.$timeout),"DEVOPS"!==this.task.type&&"TESTING"!==this.task.type&&this.$rootScope.$broadcast("tourIsAvailable",!0),this.task.singleFileMode&&0<this.task.files.length&&this.FileService.openFile(this.task.files[0].hash),this.$timeout(function(){return i.$element.removeClass("no-transition")})},Ye.prototype.$onChanges=function(e){if(e&&e.codingMode&&this.layoutManager&&(this.layoutManager.setLayout(this.layout),this.$rootScope.$broadcast("refreshEditor")),null!=e&&e.codingMode){var t=this.$element;t.removeClass("coding-mode--"+e.codingMode.previousValue),t.addClass("coding-mode--"+e.codingMode.currentValue)}},Ye.prototype.$onDestroy=function(){this.layoutManager.dispose()},Ye.prototype.isSpectator=function(){return this.examService.isSpectator()},Ye.prototype.isQuickBuildSupported=function(){return this.runtimeInfoService.isQuickBuildSupported(this.task.projectType,this.task.projectTypeVersion)},Ye.prototype.panelsContainer=function(){return this.$element.children(".panels-container")},Ye.prototype.buildPanelDiv=function(){return this.panelsContainer().children(".build-panel-wrapper")},Ye.prototype.mainContentDiv=function(){return this.panelsContainer().children(".main-content")},Ye.prototype.leftSidebar=function(){return this.panelsContainer().children(".left-sidebar")},Ye)};function Ye(e,t,i,n,o,s,r,a){this.$element=e,this.$rootScope=t,this.$scope=i,this.$timeout=n,this.buildService=o,this.examService=s,this.FileService=r,this.runtimeInfoService=a,this.tabs={activeTab:"build-console",is:function(e){return this.activeTab===e},show:function(e){this.activeTab=e}},e.addClass(e[0].tagName.toLowerCase()),e.addClass("no-transition")}var Ze={content:i("./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/programming-task.svg"),gitMode:i("./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/git-mode.svg"),editorMode:i("./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/editor-mode.svg"),downloadMode:i("./src/app/exam/steps/code-edit/programming-task-mode-selector/assets/download-mode.svg")},Ke={selector:"programmingTaskModeSelector",template:i("./src/app/exam/steps/code-edit/programming-task-mode-selector/programming-task-mode-selector.component.html"),styles:[i("./src/app/exam/pages/exam-page.less"),i("./src/app/exam/steps/code-edit/programming-task-mode-selector/programming-task-mode-selector.component.less")],bindings:{exam:"<",task:"<",inOvertimeMode:"<",switchToGitMode:"&",switchToDownloadMode:"&",switchToProgrammingMode:"&"},controller:(Je.$inject=["$element","examService"],Je.prototype.$onInit=function(){this.optionDisabledCopy="This option has been disabled by "+(this.exam.companyName||"your recruiter")+"."},Je.prototype.$onDestroy=function(){},Je.prototype.isSpectator=function(){return this.examService.isSpectator()},Je)};function Je(e,t){this.examService=t,this.images=Ze,e.addClass(e[0].tagName.toLowerCase())}var Xe=function(e,r,a,l){return new(a=a||Promise)(function(i,t){function n(e){try{s(l.next(e))}catch(e){t(e)}}function o(e){try{s(l.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}s((l=l.apply(e,r||[])).next())})},et=function(i,n){var o,s,r,e,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,s&&(r=2&t[0]?s.return:t[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,t[1])).done)return r;switch(s=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,s=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(r=0<(r=a.trys).length&&r[r.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){a.label=t[1];break}if(6===t[0]&&a.label<r[1]){a.label=r[1],r=t;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(t);break}r[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(i,a)}catch(e){t=[6,e],s=0}finally{o=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},tt={selector:"sfscratchMode",template:i("./src/app/exam/steps/code-edit/sfscratch-mode.component.html"),bindings:{task:"<",connectUrl:"<",linkRefreshed:"<",errorMessage:"<"},controller:(it.$inject=["$state","api","logger"],it.prototype.$onInit=function(){return Xe(this,void 0,void 0,function(){var t;return et(this,function(e){return t=this.task.vmResource.loginUrl,this.connectUrl=t,[2]})})},it.prototype.onRefreshUrl=function(){var t=this,e=this.api,i=this.$state;return this.linkRefreshed=!1,this.errorMessage="",this.logger.debug("[Salesforce] Refresh credentials."),e.post("assignment/"+i.params.id+"/refreshCredentials").then(function(e){t.connectUrl=e.headers("location"),t.linkRefreshed=!0}).catch(function(e){t.errorMessage="Could not refresh the link. Try again or contact support.",t.logger.error("[Salesforce] Could not refresh credentials. Error: "+e.message)})},it.prototype.openSalesforce=function(){window.open(this.connectUrl,"_blank")},it)};function it(e,t,i){this.$state=e,this.api=t,this.logger=i,this.linkRefreshed=!1}var nt=i("./src/common/code-editor/tabbed-editor-container/index.ts"),ot=l.module("exam.steps.codeEdit",["angular-intro","ngFileUpload",ie.a,te,He,x,F.a,nt.a]).component(a.selector,a).component(u.selector,u).component(f.selector,f).component(Ne.selector,Ne).component(We.selector,We).component(Qe.selector,Qe).component(Ke.selector,Ke).component(tt.selector,tt).directive("copyCommandButton",["$timeout",function(i){return{restrict:"E",scope:{command:"="},template:'<button class="btn btn-info" clipboard text="command"><i class="fa fa-copy" aria-hidden="true"></i> <span>Copy</span></button>',link:function(e,t){t.on("click",function(){t.find("span").text("Copied!"),i(function(){t.find("span").text("Copy")},2e3)})}}}]).name,st=i("./src/common/codemirror/index.ts"),rt=(i("./src/common/code-review/codemirror-review-addon.ts"),{selector:"commentsPanel",template:i("./src/app/exam/comments/comments-panel.component.html"),bindings:{comments:"<"},controller:(at.$inject=["commentService","examService","FileService"],at.prototype.isSpectator=function(){return this.examService.isSpectator()},at.prototype.getFileName=function(e){return this.FileService.getFileName(e)},at.prototype.goTo=function(e){this.FileService.openFile(e.fileHash,e.startLine+1),this.commentService.openEditMode(e)},at)});function at(e,t,i){this.commentService=e,this.examService=t,this.FileService=i}l.module("exam.comments",[]).component(rt.selector,rt).name;var lt=i("./node_modules/lodash/countBy.js"),ct=i.n(lt),dt={selector:"codeReviewStep",template:i("./src/app/exam/steps/code-review/code-review-step.component.html"),bindings:{task:"<",pageNumber:"<"},controller:(ut.$inject=["$cookies","$rootScope","$scope","$timeout","examService","FileService","firebaseService","localStorageService","ngIntroService"],ut.prototype.$onInit=function(){var i=this,e=this,t=e.$rootScope,n=e.$scope,o=e.FileService,s=e.firebaseService,r=e.localStorageService;o.setFiles(this.task.files),o.connectPageWithFirebase();var a=r.get(this.commentsStorageKey())||this.task.comments;this.task.comments=Array.isArray(a)?a:[],n.$on("fileTree.synchronized",function(){i.decorateFileTree(i.task.comments)}),n.$watch(function(){return i.task.comments},function(e){if(r.set(i.commentsStorageKey(),e),i.decorateFileTree(e),i.firebaseInitialized&&!i.examService.isSpectator()){var t=l.fromJson(l.toJson(e));t.length||(t={length:0}),s.setChildValue("comments",{comments:t})}},!0),this.initFirebaseSync(),t.$broadcast("tourIsAvailable",!0)},ut.prototype.$postLink=function(){var t=this.$cookies,i="DVSK_CodeReviewIntro";if(!this.examService.isSpectator()&&"1"!==t.get(i)){var e=this.$timeout,n=this.ngIntroService;n.setOptions({scrollToElement:!1,showStepNumbers:!1,steps:[{element:b("#files-tree").get(0),intro:"You can browse all the files contained in the project. Click on the file name to open the selected file. Each file will be opened in separate tab.",position:"right"},{element:b("#task-definition-tab").get(0),intro:"Full task description is always visible in the first tab.",position:"right"},{element:b(".comments-panel").get(0),intro:"To add a comment open any file, select a code fragment in the editor, press &quot;c&quot; and write your thoughts about the selected code.",position:"left"}]}),n.onExit(function(){var e=new Date(Date.now()+36e5);t.put(i,"1",{expires:e})}),e(function(){return n.start()})}},ut.prototype.$onDestroy=function(){this.ngIntroService.clear()},ut.prototype.initFirebaseSync=function(){var n=this,o=this.firebaseService;o.getCurrentPageRef()&&(o.registerOnValue("comments","value",function(e){var i=Array.isArray(e.comments)?e.comments:[];if(!n.firebaseInitialized){var t=i.length;n.task.comments.forEach(function(t){-1===i.findIndex(function(e){return e.uiId===t.uiId})&&i.push(t)}),i.length>t&&o.setChildValue("comments",{comments:i}),n.firebaseInitialized=!0}n.syncComments(i)}),o.getCurrentPageRef().child("comments").update({init:!0}))},ut.prototype.commentsStorageKey=function(){return"comments-"+this.task.id+"-"+this.examService.getExamToken()},ut.prototype.decorateFileTree=function(e){var t=this.$rootScope,i=Array.isArray(e)?ct()(e,function(e){return encodeURIComponent(e.fileHash)}):{};t.$broadcast("updateCommentsCounts",i)},ut.prototype.syncComments=function(e){var i=Array.isArray(this.task.comments)?this.task.comments:[];this.task.comments=i,Ie()(i,function(t){return-1===e.findIndex(function(e){return e.uiId===t.uiId})}),e.forEach(function(t){var e=i.find(function(e){return e.uiId===t.uiId});e?(e.text=t.text,e.editMode=t.editMode):i.push(t)}),this.localStorageService.set(this.commentsStorageKey(),i)},ut.prototype.getActiveFileHash=function(){return this.FileService.getActiveFileHash()},ut.prototype.isSpectator=function(){return this.examService.isSpectator()},ut)};function ut(e,t,i,n,o,s,r,a,l){this.$cookies=e,this.$rootScope=t,this.$scope=i,this.$timeout=n,this.examService=o,this.FileService=s,this.firebaseService=r,this.localStorageService=a,this.ngIntroService=l,this.firebaseInitialized=!1}var pt=i("./src/common/code-review/code-review.module.ts"),ht=l.module("exam.steps.codeReview",[pt.a,n.a,nt.a,"exam.comments","exam.files","angular-intro"]).component(dt.selector,dt).directive("codeReviewLayout",["$rootScope",function(i){return{restrict:"A",link:function(e,t){function o(){return t.children(".main-content")}e.$on("angular-resizable.resizing",function(e,t){if("left-sidebar"===t.id){var i={left:t.width};o().css(i)}if("right-sidebar"===t.id){var n={right:t.width};o().css(n)}}),e.$on("angular-resizable.resizeEnd",function(){i.$broadcast("refreshEditor")})}}}]).name,mt=i("./node_modules/checklist-model/checklist-model.js"),ft=i("./node_modules/lodash/debounce.js"),vt=i.n(ft),gt={selector:"codegapsEditor",template:i("./src/app/exam/steps/questions/codegaps-editor.component.html"),styles:[i("./src/app/exam/steps/questions/codegaps-editor.component.less")],bindings:{task:"<",readonly:"<"},controller:(bt.$inject=["$rootScope","$scope","$timeout","dialogs","firebaseService"],bt.prototype.$onInit=function(){var i=this;Array.isArray(this.task.filledGaps)||(this.task.filledGaps=[]);var e=this.$scope,t=this.dialogs,o=this.editorInstance;e.$watchCollection(function(){return i.task.filledGaps},function(){var n=!1;if(i.task.filledGaps.forEach(function(e,t,i){255<e.length&&(n=!0,i[t]=e.substr(0,255))}),n)return t.error("Max answer length exceeded","Single code gap answer cannot exceed <strong>255 characters</strong>. Your answer will be trimmed accordingly."),void o.fillGapsWithModel()}),e.$on("refreshFileNodeEditor",function(){i.refreshEditor()}),e.$on("fillGapsWithModel",function(e,t){t.taskId===i.task.id&&i.editorInstance.fillGapsWithModel()})},bt.prototype.loadMode=function(){var e=this.task;if(e&&e.mode){var t=Object(st.e)(e.mode);t&&(this.editorInstance.setOption("mode",t.mime),Object(st.c)(this.editorInstance,t.mode))}},bt.prototype.refreshEditor=function(){var e=this,t=this.$scope,i=this.$timeout;t.$evalAsync(function(){i(function(){e.editorInstance.refresh()},0)})},bt)};function bt(e,t,i,n,o){var s=this;this.$rootScope=e,this.$scope=t,this.$timeout=i,this.dialogs=n,this.firebaseService=o,this.editorOptions={readOnly:!0,lineWrapping:!0,lineNumbers:!0,mode:"java",styleActiveLine:!0,autoCloseBrackets:!0,autoCloseTags:!0,inputStyle:"textarea",selectionPointer:!0},this.codemirrorLoaded=function(e){s.editorInstance=e,s.loadMode(),s.refreshEditor(),e.setOption("codeGapsReadOnly",s.readonly),e.on("updateFilledGaps",function(){s.$timeout(function(){var e=s.firebaseService,t=s.task,i={type:"gapsChanged",taskId:t.id,filledGaps:t.filledGaps};e.addPageActivity(i),e.setChildValue("task-"+t.id,{id:t.id,filledGaps:t.filledGaps})},100)}),s.$scope.$evalAsync(function(){s.$timeout(function(){var e=s.$rootScope,t=s.task;t.gaps&&t.gaps.length&&(t.gaps.forEach(function(e){e&&e.value&&(t.filledGaps[e.gapOrder]=e.value)}),e.$broadcast("fillGapsWithModel",{taskId:t.id})),s.editorInstance.recreateGapsForCandidate(t.gaps,t.filledGaps)},0)})}}var yt=i("./src/common/markdown/index.ts"),$t=i("./src/common/directives/pagedown-editor.component.ts"),St=i("./src/app/exam/layout/confirm-next-step-modal.component.ts"),wt={selector:"questionsStep",template:i("./src/app/exam/steps/questions/questions-step.component.html"),styles:[i("./src/app/exam/steps/questions/questions-step.component.less")],bindings:{assignment:"=",exam:"=",onNextAssignment:"&"},controller:(kt.$inject=["$q","$rootScope","$scope","$timeout","dialogs","examService","firebaseService","logger"],kt.prototype.$onInit=function(){var t=this,i=this.$rootScope,o=this.$scope,s=this.firebaseService,r=this.logger;this.assignment.tasks.forEach(function(e){switch(e.type){case h.e.ESSAY:e.answer=e.value;break;case h.e.MULTI_CHOICE:e.selectedChoices=e.choices.filter(function(e){return e.selected}).map(function(e){return e.id})}}),o.$watch(function(){return s.isEnabled()},function(e){e&&!t.firebaseInitialized&&(t.firebaseInitialized=!0,t.assignment.tasks.forEach(function(n){try{s.registerOnValue("task-"+n.id,"value",function(e){e&&o.$evalAsync(function(){e.selectedChoices?n.selectedChoices=e.selectedChoices:e.textAnswer&&e.textAnswer!==n.answer?s.isCurrentUser(e.uid)||(n.answer=e.textAnswer):e.filledGaps&&(Array.isArray(n.filledGaps)||(n.filledGaps=[]),Object.entries(e.filledGaps).forEach(function(e){var t=e[0],i=e[1];n.filledGaps[t]!==i&&(n.filledGaps[t]=i)}),s.log("Filled gaps after processing value change",n.filledGaps),i.$broadcast("fillGapsWithModel",{taskId:n.id}))})})}catch(e){r.error("Error while connecting firebase to question "+e)}}))})},kt.prototype.tabs=function(e){var t=this._tabs;return t[e.id]||(t[e.id]={activeTab:"edit",is:function(e){return this.activeTab===e},show:function(e){this.activeTab=e}}),t[e.id]},kt.prototype.isSpectator=function(){return this.examService.isSpectator()},kt.prototype.isNextAssignmentAvailable=function(){return this.assignment&&!!this.assignment.nextAssignment},kt.prototype.goToNextAssignment=function(){var e=this;return this.exam.oneDirection?this.dialogs.open({component:St.a.selector,size:"lg",keyboard:!0,backdrop:"static",windowClass:"payment-form-modal colored-header",resolve:{nextAssignmentAvailable:function(){return e.isNextAssignmentAvailable()}}}).result.then(function(){return e.runOnNextAssignment()}):this.runOnNextAssignment()},kt.prototype.runOnNextAssignment=function(){var e=this;return this.loadingNextAssignment=!0,this.$q.resolve().then(function(){return e.onNextAssignment()}).catch(function(){e.loadingNextAssignment=!1})},kt.prototype.nextAssignmentLabel=function(){switch(this.assignment.nextAssignmentType){case"SINGLE_QUESTION":return"Next question";case"QUESTIONS":return"Next questions";default:return"Next task"}},kt.prototype.finishExam=function(){this.$rootScope.$broadcast("finishExam")},kt.prototype.isStaticItem=function(e){return"STATIC"===e.itemType},kt.prototype.isInputItem=function(e){return"INPUT"===e.itemType},kt.prototype.isTaskItem=function(e){return!this.isStaticItem(e)&&!this.isInputItem(e)},kt.prototype.showTaskIndex=function(e){return 1<this.assignment.tasks.length},kt.prototype.textChanged=function(i){var n=this;this.$timeout(function(){var e=n.firebaseService,t={type:"essayAnswerChanged",taskId:i.id};i.answer&&(t.textAnswer=i.answer),e.addPageActivity(t),e.setChildValue("task-"+i.id,{id:i.id,textAnswer:i.answer})},100)},kt.prototype.choiceChanged=function(i,n){var o=this;this.$timeout(function(){var e=o.firebaseService,t={type:"choiceChanged",taskId:i.id,selectedChoices:i.selectedChoices,choiceChanged:n.id};e.addPageActivity(t),e.setChildValue("task-"+i.id,{id:i.id,selectedChoices:i.selectedChoices})},100)},kt)};function kt(e,t,i,n,o,s,r,a){this.$q=e,this.$rootScope=t,this.$scope=i,this.$timeout=n,this.dialogs=o,this.examService=s,this.firebaseService=r,this.logger=a,this.loadingNextAssignment=!1,this._tabs=Object.create(null),this.firebaseInitialized=!1}var Ct=l.module("exam.steps.questions",[mt,yt.a,$t.b]).component(gt.selector,gt).component(wt.selector,wt).directive("syncFirebaseState",["$parse","firebaseService",function(r,a){return{require:"ngModel",scope:!1,link:function(i,e,t,n){var o=r(t.syncFirebaseState),s=vt()(function(){var e=o(i),t={type:"essayAnswerChanged",taskId:e.id};e.answer&&(t.textAnswer=e.answer),a.addPageActivity(t),a.setChildValue("task-"+e.id,{id:e.id,textAnswer:e.answer})},300);n.$viewChangeListeners.push(s)}}}]).name,xt=i("./src/common/services/logger.service.ts");function Ft(e,t,i,n){this.$element=e,this.$rootScope=t,this.$scope=i,this.$timeout=n,this.sidebarCollapsed=!1,this.buildPanelCollapsed=!1,this.sidebarCollapseInfo={left:0,width:0},this.buildPanelCollapseInfo={bottom:0,mainContentHeight:0,buildPanelTop:0,buildPanelHeight:0}}var Mt={selector:"sqlEditLayout",restrict:"A",controller:(Ft.$inject=["$element","$rootScope","$scope","$timeout"],Ft.prototype.$onInit=function(){var s=this,e=this.$scope,t=this.$rootScope,r=this.$element;e.$on("angular-resizable.resizing",function(e,t){var i=r.children(".main-content");if("left-sidebar"===t.id){var n={left:t.width};i.css(n),s.getBuildPanel().css(n)}if("right-sidebar"===t.id){var o={right:t.width};i.css(o),s.getBuildPanel().css(o)}"main-panel"===t.id&&s.getBuildPanel().css({height:"auto",top:t.height})}),e.$on("angular-resizable.resizeEnd",function(){t.$broadcast("refreshEditor")})},Ft.prototype.getBuildPanel=function(){return this.$element.children(".build-panel-wrapper")},Ft.prototype.getMainContent=function(){return this.$element.children(".main-content")},Ft.prototype.getLeftSidebar=function(){return this.$element.children(".left-sidebar")},Ft.prototype.isMainPanelExpanded=function(){return this.buildPanelCollapsed&&this.sidebarCollapsed},Ft.prototype.expandMainPanel=function(){this.buildPanelCollapsed||this.collapseBuildPanel(),this.sidebarCollapsed||this.collapseSidebar()},Ft.prototype.compressMainPanel=function(){this.buildPanelCollapsed&&this.showBuildPanel(),this.sidebarCollapsed&&this.showSidebar()},Ft.prototype.toggleBuildPanel=function(){this.buildPanelCollapsed?this.showBuildPanel():this.collapseBuildPanel()},Ft.prototype.collapseBuildPanel=function(){var e=this;this.buildPanelCollapsed=!0;var t=this.getBuildPanel(),i=this.getMainContent(),n=this.buildPanelCollapseInfo;n.buildPanelHeight=t.css("height"),n.buildPanelTop=t.css("top"),n.bottom=i.css("bottom"),n.mainContentHeight=i.css("height"),t.css({height:"30px",top:"auto",bottom:0}),i.css({bottom:"30px",height:"auto"}),t.addClass("collapsed"),i.addClass("build-panel-collapsed"),this.$timeout(function(){e.$rootScope.$broadcast("refreshEditor")},500)},Ft.prototype.showBuildPanel=function(){var e=this;this.buildPanelCollapsed=!1;var t=this.getBuildPanel(),i=this.getMainContent(),n=this.buildPanelCollapseInfo;t.css({height:n.buildPanelHeight,top:"auto",bottom:0}),i.css({bottom:n.bottom,height:n.mainContentHeight}),t.removeClass("collapsed"),i.removeClass("build-panel-collapsed"),this.$timeout(function(){e.$rootScope.$broadcast("refreshEditor")},500)},Ft.prototype.toggleSidebar=function(){this.sidebarCollapsed?this.showSidebar():this.collapseSidebar()},Ft.prototype.collapseSidebar=function(){var e=this;this.sidebarCollapsed=!0;var t=this.sidebarCollapseInfo;t.left=this.getMainContent().css("left"),t.width=this.getLeftSidebar().css("width"),this.getLeftSidebar().css({width:"30px"}),this.getMainContent().css({left:"40px"}),this.getBuildPanel().css({left:"40px"});var i=this.$rootScope,n=this.$timeout;n(function(){e.getLeftSidebar().addClass("collapsed")},100),n(function(){i.$broadcast("refreshEditor")},500)},Ft.prototype.showSidebar=function(){var e=this.sidebarCollapseInfo,t=this.$timeout,i=this.$rootScope;this.sidebarCollapsed=!1,this.getLeftSidebar().removeClass("collapsed"),this.getLeftSidebar().css({width:e.width}),this.getMainContent().css({left:e.left}),this.getBuildPanel().css({left:e.left}),t(function(){i.$broadcast("refreshEditor")},500)},Ft)},Tt={selector:"sqlEditStep",template:i("./src/app/exam/steps/sql-edit/sql-edit-step.component.html"),styles:[i("./src/app/exam/steps/sql-edit/sql-edit-step.component.less")],bindings:{task:"<",pageNumber:"<"},controller:(Et.$inject=["$element","$scope","buildService","FileService","logger","hotkeys"],Et.prototype.$onInit=function(){var i=this,e=this,t=e.$scope,n=e.buildService,o=e.FileService,s=e.hotkeys,r=e.task;if("SOQL"===r.projectType){var a=r.files.find(function(e){return"query.txt"===e.name})||this.FileService.createFile("","query.txt");r.fileHashes=r.fileHashes||{},r.fileHashes.QUERY=a,r.mode="SOQL",this.refreshFiles()}this.lastBuild=n.getLastBuild();var l=this;this.editorTabs={activeTab:"candidateQuery",is:function(e){return this.activeTab===e},show:function(e){var t=l.task.fileHashes;"candidateQuery"===(this.activeTab=e)?o.openFile(t.QUERY.hash):"candidateScript"===e&&o.openFile(t.SCRIPT.hash)}},n.clearBuilds(),n.connectToFirepad(),t.$on("buildService.buildReceived",function(e,t){i.lastBuild=t}),t.$watch(function(){return n.getBuilds().length},function(){i.lastBuild=n.getLastBuild(),i.tabs.show("build-console")}),t.$watch(function(){return i.lastBuild&&i.lastBuild.result},function(){i.lastBuild&&i.lastBuild.result.buildStatus&&i.logger.debug("Last build result changed for SQL task: result="+i.lastBuild.result.buildStatus)},!0),s.add({combo:"f9",description:"Run & validate",callback:function(){n.buildProject(!0)}})},Et.prototype.$postLink=function(){this.layout=this.$element.find("[sql-edit-layout]").controller("sqlEditLayout")},Et.prototype.$onChanges=function(e){e.task&&this.refreshFiles()},Et.prototype.$onDestroy=function(){this.hotkeys.del("f9")},Et.prototype.refreshFiles=function(){var e=this.FileService,t=this.task.fileHashes,i=[];if(t){var n=t.QUERY,o=t.SCRIPT;n&&(this.logger.info("[sqlEditStep] task.fileHashes.QUERY = "+JSON.stringify(n.name)),i.push(n)),o&&(this.logger.info("[sqlEditStep] task.fileHashes.SCRIPT = "+JSON.stringify(o.name)),i.push(o))}else this.logger.info("[sqlEditStep] task.fileHashes is empty");e.setFiles(i),0<i.length?(this.logger.info("[sqlEditStep] Number of files in the task: "+i.length+", opening: "+i[0].name),e.openFile(i[0].hash)):this.logger.info("[sqlEditStep] No files to open")},Et.prototype.sqlModeInfo=function(){var e=this.task;return"MYSQL"===e.mode?"MySQL 8":"POSTGRES"===e.mode?"PostgreSQL 11":"ORACLE"===e.mode?"Oracle 11":"MSSQL"===e.mode?"SQL Server 2017":"HSQLDB"===e.mode?"HSQLDB":"SOQL"===e.mode?"SOQL":"Plain SQL"},Et.prototype.isQueryEditingAvailable=function(){var e;return Boolean(null===(e=this.task.fileHashes)||void 0===e?void 0:e.QUERY)},Et.prototype.isScriptEditingAvailable=function(){var e;return Boolean(null===(e=this.task.fileHashes)||void 0===e?void 0:e.SCRIPT)},Et.prototype.isQueryFileModified=function(){var e,t=this.FileService,i=null===(e=this.task.fileHashes)||void 0===e?void 0:e.QUERY;return i&&t.isModified(i.hash)},Et.prototype.isScriptFileModified=function(){var e,t=this.FileService,i=null===(e=this.task.fileHashes)||void 0===e?void 0:e.SCRIPT;return i&&t.isModified(i.hash)},Et)};function Et(e,t,i,n,o,s){this.$element=e,this.$scope=t,this.buildService=i,this.FileService=n,this.logger=o,this.hotkeys=s,this.tabs={activeTab:"build-console",is:function(e){return this.activeTab===e},show:function(e){this.activeTab=e}}}var Pt=l.module("exam.steps.sqlEdit",["cfp.hotkeys",te,ie.a,He,xt.a,yt.a,nt.a]).component(Tt.selector,Tt).directive(Mt.selector,Object(K.a)(Mt)).name,It=l.module("exam.steps",[n.a,ot,ht,Ct,Pt]).component(o.selector,o).name},"./src/app/exam/steps/questions/codegaps-editor.component.html":function(e,t){e.exports='<textarea ng-model="$ctrl.task.snippet"\n  ui-codemirror="{ onLoad : $ctrl.codemirrorLoaded }"\n  ui-codemirror-opts="$ctrl.editorOptions"\n></textarea>\n'},"./src/app/exam/steps/questions/codegaps-editor.component.less":function(e,t,i){},"./src/app/exam/steps/questions/questions-step.component.html":function(e,t){e.exports='<div class="content-container">\n  <div class="questions-list">\n    <div class="question" ng-repeat="task in $ctrl.assignment.tasks">\n      <div class="question__header" ng-if="$ctrl.isTaskItem(task)">\n        <task-feedback task="task"></task-feedback>\n        <h2>Question <span ng-if="$ctrl.showTaskIndex(task)">#{{ task.index }}</span></h2>\n      </div>\n      <div class="question__content" ng-class=" { \'limited-access-question\' : task.limitedAccess }">\n        <div class="limited-access alert alert-warning alert-block" ng-if="task.limitedAccess">\n          <strong>\n            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Limited access!\n          </strong>\n          <strong>Upgrade your plan to access this task.</strong>\n        </div>\n        <markdown-content\n          item="task" exam="$ctrl.exam"\n          ng-if="$ctrl.isStaticItem(task) && task.type == \'MARKDOWN\'"\n        ></markdown-content>\n        <form ng-if="$ctrl.isInputItem(task) && task.inputType !== \'PHOTO_CAPTURE\'">\n          <candidate-input item="task" exam="$ctrl.exam" ng-model="task.value"></candidate-input>\n        </form>\n        <div ng-if="$ctrl.isInputItem(task) && task.inputType === \'PHOTO_CAPTURE\'">\n          <candidate-input item="task" exam="$ctrl.exam" ng-model="task.value"></candidate-input>\n        </div>\n        <div class="question__text" render-markdown content="task.question" ng-if="$ctrl.isTaskItem(task)"></div>\n\n        <div ng-switch on="task.type">\n          <div ng-switch-when="CODE_GAPS">\n            <codegaps-editor task="task" readonly="$ctrl.isSpectator()"></codegaps-editor>\n          </div>\n          <div ng-switch-when="ESSAY">\n            <ul class="nav nav-tabs nav-tabs-inner" role="tablist">\n              <li ng-class="{ \'active\' : $ctrl.tabs(task).is(\'edit\') }">\n                <a href role="tab" ng-click="$ctrl.tabs(task).show(\'edit\')">Edit</a>\n              </li>\n              <li ng-class="{ \'active\' : $ctrl.tabs(task).is(\'preview\') }">\n                <a href role="tab" ng-click="$ctrl.tabs(task).show(\'preview\')">Preview</a>\n              </li>\n            </ul>\n            <div class="tab-content inner" style="margin-bottom: 0;">\n              <div class="tab-pane" ng-class="{ \'active\' : $ctrl.tabs(task).is(\'edit\') }">\n                <pagedown-editor\n                  content="task.answer"\n                  ng-model="task.answer"\n                  sync-firebase-state="task"\n                  show-preview="false"\n                  image-picker="{ gallery: false }"\n                ></pagedown-editor>\n                <p class="help-block text-muted">You can use Markdown syntax to format the text.</p>\n              </div>\n              <div class="tab-pane" ng-class="{ \'active\' : $ctrl.tabs(task).is(\'preview\') }">\n                <div class="answer-preview" render-markdown content="task.answer"></div>\n              </div>\n            </div>\n          </div>\n          <fieldset ng-switch-when="MULTI_CHOICE" class="question__choices">\n            <legend class="sr-only">\n              {{ ::task.singleChoice ? \'Choose the right answer\' : \'Choose the right answers\' }}\n            </legend>\n\n            <div\n              ng-repeat="choice in task.choices"\n              ng-if="task.singleChoice"\n              class="question__choice"\n            >\n              <input\n                type="radio"\n                ng-model="task.selectedChoices"\n                ng-change="$ctrl.choiceChanged(task, choice)"\n                ng-value="{{ choice.id }}"\n                ng-disabled="$ctrl.isSpectator()"\n                name="optionsRadios{{ task.id }}"\n                id="optionsRadios{{ task.id }}_{{ $index }}"\n              />\n              <label for="optionsRadios{{ task.id }}_{{ $index }}">\n                <div class="question__radio"></div>\n                <span render-markdown content="choice.text"></span>\n              </label>\n            </div>\n\n            <div\n              ng-repeat="choice in task.choices"\n              ng-if="!task.singleChoice"\n              class="question__choice"\n            >\n              <input\n                type="checkbox"\n                checklist-model="task.selectedChoices"\n                checklist-value="choice.id"\n                ng-change="$ctrl.choiceChanged(task, choice)"\n                ng-disabled="$ctrl.isSpectator()"\n                name="optionsCheckboxes{{ task.id }}"\n                id="optionsCheckboxes{{ task.id }}_{{ $index }}"\n              />\n              <label for="optionsCheckboxes{{ task.id }}_{{ $index }}">\n                <div class="question__checkbox">\n                  <dvsk-icon icon="check" size="18"></dvsk-icon>\n                </div>\n                <span render-markdown content="choice.text"></span>\n              </label>\n            </div>\n\n          </fieldset>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div ng-if="!$ctrl.isSpectator()" class="next-step">\n    <button dvsk-button size="large" loading="$ctrl.loadingNextAssignment" ng-if="$ctrl.isNextAssignmentAvailable()" ng-click="$ctrl.goToNextAssignment()">\n      <span>{{ $ctrl.nextAssignmentLabel() }}</span> <i class="fa fa-angle-right" aria-hidden="true"></i>\n    </button>\n    <button dvsk-button size="large" ng-if="!$ctrl.isNextAssignmentAvailable()" ng-click="$ctrl.finishExam()">\n      Finish test\n    </button>\n  </div>\n</div>\n'},"./src/app/exam/steps/questions/questions-step.component.less":function(e,t,i){},"./src/app/exam/steps/sql-edit/sql-edit-step.component.html":function(e,t){e.exports='<div class="step-pane-content sql-edit-page">\n\n  <div class="panels-container" sql-edit-layout>\n    <div class="left-sidebar" id="left-sidebar" resizable r-directions="[\'right\']" r-width="600">\n\n      <div class="collapsed-problem-description" ng-click="$ctrl.layout.showSidebar()">\n        <div class="show-problem-description-button">Task description</div>\n      </div>\n      <div class="problem-description-panel">\n\n        <div class="block-flat">\n          <div class="header">\n            <span class="fa fa-angle-double-left pull-right"\n                  ng-class="{ \'fa-angle-double-left\': $ctrl.layout.sidebarCollapsed, \'fa-angle-double-down\': !$ctrl.layout.sidebarCollapsed }"\n                  ng-click="$ctrl.layout.toggleSidebar()"></span>\n            <h3>Task description</h3>\n          </div>\n          <div class="content">\n            <div id="task-definition">\n              <div class="question-text" render-markdown content="$ctrl.task.question"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="main-content" id="main-panel" resizable\n         r-directions="[\'bottom\']">\n      <div class="expand-editor-button fa fa-expand" ng-click="$ctrl.layout.expandMainPanel()" ng-show="!$ctrl.layout.isMainPanelExpanded()"\n           uib-tooltip="Expand editor" tooltip-placement="left" tooltip-append-to-body="true"></div>\n      <div class="expand-editor-button fa fa-compress" ng-click="$ctrl.layout.compressMainPanel()" ng-show="$ctrl.layout.isMainPanelExpanded()"\n           uib-tooltip="Collapse editor" tooltip-placement="left" tooltip-append-to-body="true"></div>\n      <div class="main-content-wrapper">\n        <div class="tab-container">\n          <ul class="nav nav-tabs">\n            <li ng-class="{ \'active\' : $ctrl.editorTabs.is(\'candidateQuery\') }" ng-if="$ctrl.isQueryEditingAvailable()">\n              <a href ng-click="$ctrl.editorTabs.show(\'candidateQuery\')">\n                <span ng-show="$ctrl.isQueryFileModified()">*</span>\n                <span class="file-name" title="Query editor">Query editor</span>\n              </a>\n            </li>\n            <li ng-class="{ \'active\' : $ctrl.editorTabs.is(\'candidateScript\') }" ng-if="$ctrl.isScriptEditingAvailable()">\n              <a href ng-click="$ctrl.editorTabs.show(\'candidateScript\')">\n                <span ng-show="$ctrl.isScriptFileModified()">*</span>\n                <span class="file-name" title="Query editor">Script editor</span>\n              </a>\n            </li>\n          </ul>\n          <div class="tab-content">\n            <div class="limited-access alert alert-warning alert-block" ng-if="$ctrl.task.limitedAccess">\n              <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>\n              <strong>Limited access! Upgrade your plan to access this task.</strong>\n            </div>\n            <div id="code-editor" class="editor-tab tab-pane cont active">\n              <div class="editor-container">\n                <code-editor class="code-editor-wrapper" sql-mode="true"></code-editor>\n              </div>\n              <editor-status-bar additional-mode-info="$ctrl.sqlModeInfo()"></editor-status-bar>\n            </div>\n          </div>\n\n        </div>\n\n      </div>\n    </div>\n\n    <div class="build-panel-wrapper" id="build-panel-wrapper">\n      <div class="build-panel-buttons" ng-if="$ctrl.task.projectType === \'SOQL\'">\n        <button\n          build-project-button\n          task="$ctrl.task"\n          tabs="$ctrl.tabs"\n          tab="build-console"\n          class="toolbar-btn btn btn-primary"\n          ng-if="!$ctrl.isSpectator()"\n        ></button>\n        <button\n          build-project-button\n          task="$ctrl.task"\n          tabs="$ctrl.tabs"\n          tab="build-console"\n          class="toolbar-btn btn btn-primary"\n          ng-if="!$ctrl.isSpectator() && $ctrl.isQuickBuildSupported()"\n          quick-build="true"\n        ></button>\n      </div>\n\n      <div class="collapsed-build-panel">\n        <span ng-click="$ctrl.layout.showBuildPanel(\'build-console\')"> Results\n          <span class="fa fa-exclamation-triangle color-warning" uib-tooltip="Last build: Tests failed"\n                tooltip-append-to-body="true" ng-show="$ctrl.lastBuild.isTestFailure()"></span>\n          <span class="fa fa-times-circle color-danger" uib-tooltip="Last build: failed" tooltip-append-to-body="true"\n                ng-show="$ctrl.lastBuild.isFailure()"></span>\n          <span class="fa fa-check-circle color-success" uib-tooltip="Last build: Success!" tooltip-append-to-body="true"\n                ng-show="$ctrl.lastBuild.isSuccess()"></span></span>\n\n        <span class="filler" ng-click="$ctrl.layout.showBuildPanel()">\n          <span class="show-console fa fa-angle-double-up" uib-tooltip="Show" tooltip-append-to-body="true"\n                ng-click="$ctrl.layout.showBuildPanel()"></span>\n        </span>\n      </div>\n      <div class="tab-container">\n        <ul class="nav nav-tabs">\n          <li ng-class="{ \'active\' : $ctrl.tabs.is(\'build-console\') }">\n            <a href ng-click="$ctrl.tabs.show(\'build-console\')">\n              <i class="fa fa-terminal" aria-hidden="true"></i>\n              <span class="tab-label">Results</span>\n              <span class="fa fa-exclamation-triangle color-warning" uib-tooltip="Last build: Tests failed"\n                    tooltip-append-to-body="true" ng-show="$ctrl.lastBuild.isTestFailure()"></span>\n              <span class="fa fa-times-circle color-danger" uib-tooltip="Last build: failed" tooltip-append-to-body="true"\n                    ng-show="$ctrl.lastBuild.isFailure()"></span>\n              <span class="fa fa-check-circle color-success" uib-tooltip="Last build: Success!"\n                    tooltip-append-to-body="true"\n                    ng-show="$ctrl.lastBuild.isSuccess()"></span>\n              <span class="fa fa-angle-double-left pull-right"\n                    ng-class="{ \'fa-angle-double-left\': $ctrl.layout.buildPanelCollapsed, \'fa-angle-double-down\': !$ctrl.layout.buildPanelCollapsed }"\n                    ng-click="$ctrl.layout.toggleBuildPanel()"></span>\n            </a>\n          </li>\n        </ul>\n        <span class="hide-console fa fa-angle-double-down" uib-tooltip="Hide" tooltip-append-to-body="true"\n              ng-click="$ctrl.layout.collapseBuildPanel()"></span>\n\n        <div class="tab-content">\n          <div class="tab-pane cont" ng-class="{ \'active\' : $ctrl.tabs.is(\'build-console\') }">\n            <section class="build-panel-tab-pane" ng-if="$ctrl.task.type === \'SQL\'">\n              <exam-sql-build-panel task="$ctrl.task" last-build="$ctrl.lastBuild"></exam-sql-build-panel>\n            </section>\n            <section class="build-panel-tab-pane" ng-if="$ctrl.task.projectType === \'SOQL\'">\n              <build-panel task="$ctrl.task" last-build="$ctrl.lastBuild" tabs="$ctrl.tabs"></build-panel>\n            </section>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</div>\n'},"./src/app/exam/steps/sql-edit/sql-edit-step.component.less":function(e,t,i){},"./src/common/code-editor/code-editor.component.less":function(e,t,i){},"./src/common/code-editor/code-editor.component.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return n});var a=i("./node_modules/angular/index.js"),y=i("./node_modules/firepad/dist/firepad.js"),$=i("./src/common/codemirror/index.ts"),c=function(){return(c=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n={selector:"codeEditor",template:'\n    <div class="code-editor__overlay">\n      <dvsk-loader centered></dvsk-loader>\n    </div>\n    <div class="code-editor__wrapper"></div>\n  ',styles:[i("./src/common/code-editor/code-editor.component.less")],bindings:{readonly:"<",violations:"<",sqlMode:"<"},controller:(o.$inject=["$compile","$element","$rootScope","$scope","$timeout","examService","FileService","firebaseService","hotkeys","logger","codeEditorService","codeMirror"],o.prototype.$onChanges=function(){this.synchronizeViolations()},o.prototype.$onInit=function(){var n=this,e=this.codeMirror;$.a.commands.save=function(e){!e.getOption("readOnly")&&e.onSave&&e.onSave()},$.a.commands.autocomplete=function(e){e.showHint({hint:$.a.hint.anyword})},this.savedPositions={},this.editorDocs={},this.initEditor();var t=this.sqlMode?e.findModeByExtension("sql"):e.findModeByExtension("java");this.setEditorMode(t);var i=this.$scope,o=this.editor;i.$on("refreshEditor",function(){n.refreshEditor()}),i.$on("revertedFileContent",function(e,t){t.hash===n.currentFileHash&&(o.firepad?o.firepad.setText(t.content):o.getDoc().setValue(t.content))}),i.$watch(function(){return n.violations},function(e){n.synchronizeViolations()}),i.$watch(function(){var e=n.FileService.getActiveContext(),t=e.file,i=e.line;return{hash:t?t.hash:null,content:t?t.content:null,contentType:t?t.contentType:null,line:i}},function(){n.onActiveFileChange()},!0),this.keymap.forEach(function(e){var t=n.hotkeys;window.navigator&&window.navigator.platform.includes("Mac")&&(e.combo=e.combo.replace("ctrl","command")),t.add({combo:e.combo,description:e.description,callback:function(){},allowIn:["TEXTAREA"]})})},o.prototype.$onDestroy=function(){var t=this.hotkeys;this.keymap.forEach(function(e){return t.del(e.combo)})},o.prototype.initEditor=function(){var e=this,t=this.$element,i=this.$rootScope,n=this.codeMirror.create(t.children(".code-editor__wrapper"),{readOnly:!1,lineNumbers:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],lineWrapping:!0,styleActiveLine:!0,autoCloseBrackets:!0,autoCloseTags:!0,selectionPointer:!0,extraKeys:{"Ctrl-Space":"autocomplete",F9:function(){i.$broadcast("buildCurrentProject",{saveAll:e.sqlMode})},Tab:function(e){if(e.somethingSelected())e.indentSelection("add");else{var t=e.getOption("indentWithTabs")?"\t":Array(e.getOption("indentUnit")+1).join(" ");e.replaceSelection(t,"end","+input")}}}}),o=this.$timeout,s=this.$scope,r=this.FileService;n.onSave=function(){e.FileService.saveActiveFile()},n.on("changes",function(){e.isOpeningInProgress||o(function(){s.$apply(function(){e.currentFileHash&&r.setFileContent(e.currentFileHash,n.getDoc().getValue())})})}),this.editor=n},o.prototype.onActiveFileChange=function(){var e,t,i=this,n=this,o=n.$element,s=n.$timeout,r=n.FileService,a=n.editor,l=n.firebaseService,c=n.logger;null!==(t=(e=o.find(".nav-tabs")).tabdrop)&&void 0!==t&&t.call(e,"layout");var d=r.getActiveContext();if(d.file){var u=d.file,p=this.editor;if(this.currentFileHash&&(this.savedPositions[this.currentFileHash]={lastCursorPos:p.getCursor(),lastScrollPos:p.getScrollInfo()},this.editorDocs[this.currentFileHash]=p.getDoc()),a.setOption("readOnly",this.readonly||u.attributes.readOnly),null==u.content)this.currentFileHash=null;else{if(u.hash!==this.currentFileHash){if(this.isOpeningInProgress)return;if(this.setOpeningInProgress(!0),a.firepad&&a.firepad.dispose(),this.currentFileHash=u.hash,c.info("[codeEditor] Updating editor, firebaseEnabled="+l.isEnabled()+" filename="+this.filename(u.hash)+", hash="+u.hash),l.isEnabled()&&l.getCurrentPageRef()){c.info("[codeEditor] editor.swapDoc filename="+this.filename(u.hash)+", hash="+u.hash),a.swapDoc($.a.Doc(""));var h=l.getCurrentPageRef().child(u.hash);c.info("[codeEditor] Creating firepad");var m=y.fromCodeMirror(h,a,{richTextShortcuts:!1,richTextToolbar:!1}),f=Date.now(),v=!1,g=s(function(){c.warn("[codeEditor] Firepad hasn't initialized within 3000 ms"),i.setupEditorForFile(u),v=!0},3e3);m.on("ready",function(){s.cancel(g),v?c.warn("[codeEditor] Firepad 'ready' event occured after "+(Date.now()-f)+" ms, but was dismissed"):i.setupEditorForFile(u,m)})}else{var b=this.editorDocs[this.currentFileHash];b?b.setValue(""):b=$.a.Doc(""),a.swapDoc(b),this.isContentEditable(u.contentType)?(a.operation(function(){if("FILE"===u.type){var e=i.findModeByFileName(u.name);i.setEditorMode(e,u)}if(p.getDoc().setValue(u.content||""),i.savedPositions[i.currentFileHash]){var t=i.savedPositions[i.currentFileHash];p.getDoc().setCursor(t.lastCursorPos.line,t.lastCursorPos.ch),t.lastScrollPos.top&&p.scrollTo(null,t.lastScrollPos.top)}}),p.hasFocus()||p.focus()):this.setEditorMode(null),this.setOpeningInProgress(!1)}}d.line&&this.scrollToLine()}this.refreshEditor(),this.synchronizeViolations()}},o.prototype.filename=function(e){try{return atob(e)}catch(e){return"[[ invalid ]]"}},o.prototype.setupEditorForFile=function(i,n){var o=this,s=this.editor,r=this.examService,e=this.firebaseService,a=this.logger;try{this.isContentEditable(i.contentType)?(s.operation(function(){if("FILE"===i.type){var e=o.findModeByFileName(i.name);o.setEditorMode(e,i)}if(r.isCandidate()&&(n?n.isHistoryEmpty()&&n.getText()!==i.content?(a.info("[codeEditor] firepad.ready Setting file content, filename="+o.filename(i.hash)+", hash="+i.hash),n.setText(i.content)):a.info("[codeEditor] firepad.ready Not setting file content, filename="+o.filename(i.hash)+", hash="+i.hash):(a.info("[codeEditor] firepad not available, setting file content, filename="+o.filename(i.hash)+", hash="+i.hash),s.getDoc().setValue(i.content||""))),o.savedPositions[o.currentFileHash]){var t=o.savedPositions[o.currentFileHash];s.getDoc().setCursor(t.lastCursorPos.line,t.lastCursorPos.ch),t.lastScrollPos.top&&s.scrollTo(null,t.lastScrollPos.top)}}),s.hasFocus()||s.focus(),e.addPageActivity({type:"file_opened",hash:i.hash}),a.info("[codeEditor] firebase.addPageActivity: type=file_opened, filename="+this.filename(i.hash)+", hash="+i.hash)):(a.info("[codeEditor] firepad.ready File not editable: filename="+this.filename(i.hash)+", hash="+i.hash),this.setEditorMode(null))}catch(e){a.warn("[codeEditor] Catched error while switching editor content: "+e)}finally{this.setOpeningInProgress(!1)}},o.prototype.findModeByFileName=function(e){return this.sqlMode?this.codeMirror.findModeByExtension("sql"):this.codeMirror.findModeByFileName(e)},o.prototype.setEditorMode=function(e,t){var i=this.$element,n=this.$rootScope,o=this.editor,s={indentWithTabs:!1,indentUnit:4,tabSize:4};Object.keys(s).forEach(function(e){o.setOption(e,s[e])});var r=o.getOption("tabSize"),a=this.detectIndent(t&&t.content||"");a&&("\t"===a?(o.setOption("indentWithTabs",!0),o.setOption("indentUnit",r)):(o.setOption("indentWithTabs",!1),o.setOption("indentUnit",a.length))),n.$broadcast("editorModeChanged",c(c({},e),{tabSize:r,indentWithTabs:o.getOption("indentWithTabs"),indentUnit:o.getOption("indentUnit"),readOnly:o.getOption("readOnly")}));var l=i.attr("class").split(/\s+/).filter(function(e){return!/^(tab-size|mode)-/.test(e)});l.push("tab-size-"+r),i.attr("class",l.join(" ")),e&&(this.setModeClass(e.mode),o.setOption("mode",e.mime),this.codeMirror.autoLoadMode(o,e.mode))},o.prototype.detectIndent=function(e){return String(e||"").split("\n").map(function(e){var t=e.replace(/[ \t\r]+$/,"").match(/^([ \t]+)/);if(!t)return null;if("\t"===t[1][0])return"\t";var i=t[1].replace(/\t/g,"");return i.length%2==0?i:null}).filter(Boolean)[0]},o.prototype.setModeClass=function(e){var t=this.$element;this.currentMode&&t.removeClass("mode-"+this.currentMode),this.currentMode=e,t.addClass("mode-"+e)},o.prototype.refreshEditor=function(){var e=this,t=this.$scope,i=this.$timeout;t.$evalAsync(function(){i(function(){e.editor.refresh()},0)})},o.prototype.isContentEditable=function(e){return!e||this.codeEditorService.isContentTypeSupported(e)},o.prototype.scrollToLine=function(){var e=this.editor,t=this.FileService.getActiveContext();t.line&&e.scrollIntoView({line:t.line,ch:0})},o.prototype.compileViolationWidget=function(e,t){var i=this.$compile,n=this.$scope,o=this.editor.getDoc(),s=a.element('<code-violation violation="violation"></code-violation>'),r=n.$new();return a.extend(r,t),i(s)(r),o.addLineWidget(e,s.get(0),{coverGutter:!0,insertAt:0})},o.prototype.showViolations=function(e){var i=this;this.violationWidgets.length&&(this.violationWidgets.forEach(function(e){i.editor.getDoc().removeLineWidget(e)}),this.violationWidgets=[]),e&&e.forEach(function(e){var t=i.compileViolationWidget(e.endLine-1,{violation:e});i.violationWidgets.push(t)})},o.prototype.synchronizeViolations=function(){var t=this,e=this.$scope,n=this.FileService;e.$evalAsync(function(){var e=[],i=n.getActiveContext();i.file&&t.violations&&(e=t.violations.filter(function(e){var t;return e.fileHash===(null===(t=i.file)||void 0===t?void 0:t.hash)})),t.showViolations(e)})},o.prototype.setOpeningInProgress=function(e){this.isOpeningInProgress=e;var t=this.$element.find(".code-editor__overlay");e?t.show():t.hide()},o)};function o(e,t,i,n,o,s,r,a,l,c,d,u){this.$compile=e,this.$element=t,this.$rootScope=i,this.$scope=n,this.$timeout=o,this.examService=s,this.FileService=r,this.firebaseService=a,this.hotkeys=l,this.logger=c,this.codeEditorService=d,this.codeMirror=u,this.readonly=!1,this.violationWidgets=[],this.sqlMode=!1,this.savedPositions={},this.editorDocs={},this.keymap=[{combo:"ctrl+d",description:"Delete line"},{combo:"ctrl+z",description:"Undo"},{combo:"shift+ctrl+z",description:"Redo"},{combo:"ctrl+up",description:"Go Line up"},{combo:"ctrl+down",description:"Go Line down"},{combo:"ctrl+left",description:"Go group left"},{combo:"ctrl+right",description:"Go group down"},{combo:"ctrl+s",description:"Save"},{combo:"ctrl+f",description:"Find"},{combo:"ctrl+g",description:"Find next"},{combo:"shift+ctrl+g",description:"Find previous"},{combo:"shift+ctrl+f",description:"Replace"},{combo:"shift+ctrl+r",description:"Replace all"},{combo:"ctrl+[",description:"Indent less"},{combo:"ctrl+]",description:"Indent more"}]}},"./src/common/code-editor/code-editor.module.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("./node_modules/angular/index.js"),o=(i("./node_modules/angular-hotkeys/build/hotkeys.js"),i("./src/common/code-editor/code-editor.component.ts")),s=(r.prototype.getSupportedMimeTypes=function(){return this.supportedMimeTypes},r.prototype.isContentTypeSupported=function(t){return t.startsWith("text")||this.supportedMimeTypes.some(function(e){return t.startsWith(e)})},r);function r(){this.supportedMimeTypes=["application/javascript","application/json","application/x-csh","application/x-javascript","application/x-latex","application/x-perl","application/x-sh","application/x-tcl","application/x-tex","application/xml","application/xquery"]}var a=i("./src/common/codemirror/index.ts"),l=i("./src/common/services/logger.service.ts"),c=n.module("common.codeEditor",["cfp.hotkeys",a.b,l.a]).service("codeEditorService",s).component(o.a.selector,o.a).name},"./src/common/code-editor/editor-status-bar/editor-status-bar.component.html":function(e,t){e.exports='<span ng-if="$ctrl.currentMode" class="push-10-r">\n  Mode: <strong>{{ $ctrl.currentMode }}</strong>\n  <span ng-if="$ctrl.additionalModeInfo">({{ $ctrl.additionalModeInfo }})</span>\n</span>\n<span ng-if="$ctrl.indentInfo" class="push-10-r">{{ $ctrl.indentInfo }}</span>\n<span ng-if="$ctrl.readOnly" class="pull-right">Read only</span>\n\n<a ng-if="$ctrl.cheatSheet" href ng-click="$ctrl.showCheatSheet()" class="pull-right">\n  <i class="fa fa-keyboard-o" aria-hidden="true"></i> Show keyboard shortcuts\n</a>\n'},"./src/common/code-editor/editor-status-bar/editor-status-bar.component.less":function(e,t,i){},"./src/common/code-editor/index.ts":function(e,t,i){"use strict";i("./src/common/code-editor/code-editor.component.ts");var n=i("./src/common/code-editor/code-editor.module.ts");i.d(t,"a",function(){return n.a})},"./src/common/code-editor/tabbed-editor-container/index.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i("./node_modules/angular/index.js"),o=i("./src/common/code-editor/code-editor.module.ts"),s=i("./src/common/dialogs/index.ts"),r=(i("./node_modules/angular-hotkeys/build/hotkeys.js"),{selector:"editorStatusBar",template:i("./src/common/code-editor/editor-status-bar/editor-status-bar.component.html"),styles:[i("./src/common/code-editor/editor-status-bar/editor-status-bar.component.less")],bindings:{additionalModeInfo:"<"},controller:(a.$inject=["$scope","hotkeys"],a.prototype.$onInit=function(){var i=this;this.$scope.$on("editorModeChanged",function(e,t){i.indentInfo=t?t.indentWithTabs?"Tab Size: "+t.tabSize:"Spaces: "+t.indentUnit:null,t&&t.name?i.currentMode=t.name:i.currentMode="Plain Text",i.readOnly=t&&t.readOnly,i.cheatSheet=!i.readOnly})},a.prototype.showCheatSheet=function(){this.hotkeys.toggleCheatSheet()},a)});function a(e,t){this.$scope=e,this.hotkeys=t,this.cheatSheet=!1}var l=n.module("common.codeEditor.statusBar",["cfp.hotkeys"]).component(r.selector,r).name,c=i("./src/common/markdown/index.ts"),d="confirmCloseModifiedFile",u={selector:"tabbedEditorContainer",template:i("./src/common/code-editor/tabbed-editor-container/tabbed-editor-container.component.html"),styles:[i("./src/common/code-editor/tabbed-editor-container/tabbed-editor-container.component.less")],transclude:!0,bindings:{task:"<",taskDefinitionVisible:"<",readonly:"<"},controller:(p.$inject=["$element","$scope","dialogs","FileService","codeEditorService"],p.prototype.$onInit=function(){var s=this;this.$element.addClass(this.$element.prop("tagName").toLowerCase()),this.$scope.$watch(function(){var e=s.FileService.getActiveContext();return{hash:e.file?e.file.hash:null,content:e.file?e.file.content:null,contentType:e.file?e.file.contentType:null,line:e.line}},function(){var e=s.$element,t=s.FileService,i=t.getActiveContext();if(i.file){var n=i.file;s.fileReadOnly=s.readonly||n.attributes.readOnly,e.find(".limited-access-file-info").hide(),s.task&&s.task.limitedAccess?(e.find(".editor-container").hide(),e.find(".binary-file-info").hide(),e.find(".limited-access-file-info").show()):null==n.content?(e.find(".editor-container").hide(),e.find(".binary-file-info").hide(),s.currentFileHash=null):n.hash!==s.currentFileHash&&(s.currentFileHash=n.hash,s.isContentEditable(n)?(s.currentFileContent=n.content,s.currentFile=n,e.find(".editor-container").show(),e.find(".binary-file-info").hide()):(e.find(".editor-container").hide(),e.find(".binary-file-info").show()))}else if(!s.isTaskDefinitionVisible()){var o=s.getOpenedFiles()[0];o&&t.setActive(o.hash)}},!0)},p.prototype.isContentEditable=function(e){if(""===e.content)return!0;var t=e.contentType;return!t||this.codeEditorService.isContentTypeSupported(t)},p.prototype.showTaskDefinition=function(){this.FileService.setActive(null)},p.prototype.showFile=function(e){this.FileService.setActive(e)},p.prototype.closeFile=function(e,t){e.preventDefault(),e.stopPropagation();var i=this.FileService,n=this.dialogs;if(i.isModified(t)){var o=this.getOpenedFiles().filter(function(e){return e.hash===t})[0];n.open({component:d,resolve:{hash:function(){return t},file:function(){return o}},size:"lg",keyboard:!0,backdrop:"static",windowClass:"colored-header"})}else i.closeFile(t)},p.prototype.isTaskDefinitionVisible=function(){return!!this.taskDefinitionVisible},p.prototype.isActiveTaskDefinition=function(){return!this.FileService.getActiveFile()},p.prototype.isActiveTabForFile=function(e){return this.FileService.isActive(e)},p.prototype.isSingleFileMode=function(){return this.task&&this.task.singleFileMode},p.prototype.isSomeFileActive=function(){return Boolean(this.FileService.getActiveFile())},p.prototype.getOpenedFiles=function(){return this.FileService.getOpenedFiles()},p)};function p(e,t,i,n,o){this.$element=e,this.$scope=t,this.dialogs=i,this.FileService=n,this.codeEditorService=o}var h=n.module("exam.tabbedEditorContainer",[o.a,s.a,l,c.a]).component(u.selector,u).name},"./src/common/code-editor/tabbed-editor-container/tabbed-editor-container.component.html":function(e,t){e.exports='<div class="tab-container">\n  <ul class="nav nav-tabs">\n    <li id="task-definition-tab" ng-class="{ \'active\': !$ctrl.isSomeFileActive() }" ng-show="$ctrl.isTaskDefinitionVisible()">\n      <a href ng-click="$ctrl.showTaskDefinition()">\n        <i class="fa fa-lg fa-fw fa-list-alt" aria-hidden="true" style="vertical-align: middle;"></i> Task description\n      </a>\n    </li>\n\n    <li class="tab-file" id="tab-file-{{ file.hash }}"\n      ng-repeat="file in $ctrl.getOpenedFiles()"\n      ng-class="{ \'active\': $ctrl.isActiveTabForFile(file.hash), \'is-modified\': file.isModified() }"\n    >\n      <a href ng-click="$ctrl.showFile(file.hash)">\n        <span ng-show="file.isModified()">*</span>\n        <span class="file-name" title="{{ file.name }}" ng-show="!$ctrl.isSingleFileMode()">{{ file.name }}</span>\n        <span class="file-name" title="Solution editor" ng-show="$ctrl.isSingleFileMode()">Solution editor</span>\n        <span class="close-tab" aria-label="Close tab" ng-click="$ctrl.closeFile($event, file.hash)" ng-show="!$ctrl.isSingleFileMode()">\n          <i class="fa fa-times" aria-hidden="true"></i>\n        </span>\n      </a>\n    </li>\n  </ul>\n  <div class="tab-content">\n    <div class="tab-pane cont no-files-are-open" ng-class="{ \'active\': !$ctrl.isSomeFileActive() }" ng-if="!$ctrl.isSingleFileMode() && !$ctrl.isTaskDefinitionVisible()">\n      <h3>No files are open</h3>\n      <p class="lead">Open a file using the file tree on the left.</p>\n    </div>\n    <div class="limited-access alert alert-warning alert-block" ng-if="$ctrl.task.limitedAccess">\n      <strong><i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Limited access!</strong>\n      <strong>Unlock this task by upgrading your plan.</strong>\n    </div>\n    <div id="task-definition" class="tab-pane cont" ng-class="{ \'active\': $ctrl.isActiveTaskDefinition() }" ng-show="$ctrl.isTaskDefinitionVisible()">\n      <div class="question-text" render-markdown content="$ctrl.task.question"></div>\n    </div>\n    <div id="code-editor" class="editor-tab tab-pane cont" ng-class="{ \'active\' : $ctrl.isSomeFileActive() }">\n      <div id="binaryFileInfo" class="binary-file-info" style="display: none;">\n        <div class="binary-file-info-content">\n          <div class="well">\n            <h4>The selected file cannot be edited, as it\'s a binary file.</h4>\n          </div>\n        </div>\n      </div>\n      <div id="limitedAccessInfo" class="limited-access-file-info" style="display: none;">\n        <div class="binary-file-info-content">\n          <div class="well">\n            <h4>This content is not available on your current plan. </h4>\n          </div>\n        </div>\n      </div>\n      <div class="editor-container-wrapper">\n        <div class="editor-container" ng-transclude></div>\n      </div>\n      <editor-status-bar></editor-status-bar>\n    </div>\n  </div>\n</div>\n'},"./src/common/code-editor/tabbed-editor-container/tabbed-editor-container.component.less":function(e,t,i){},"./src/common/code-review/code-comment.component.html":function(e,t){e.exports='<div class="code-comment" ui-id="{{ $ctrl.comment.uiId }}" ng-class="{ \'comment-editing\' : $ctrl.isEditMode() }" ng-show="!$ctrl.comment.hidden">\n  <div class="code-comment-icon">\n    <i class="glyphicon glyphicon-comment" aria-hidden="true"></i>\n  </div>\n  <div class="code-comment-content">\n    <textarea\n      ng-model="$ctrl.commentModel"\n      ng-show="$ctrl.isEditMode()"\n      ng-keydown="$ctrl.handleKeyDown($event)"\n      maxlength="1024"\n    ></textarea>\n    <small ng-show="$ctrl.isEditMode()">{{ $ctrl.hotkeysMessage }}</small>\n    <blockquote ng-hide="$ctrl.isEditMode()" ng-click="$ctrl.edit()">{{ $ctrl.comment.text || \'\\n\' }}</blockquote>\n\n    <div class="clear"></div>\n    <button class="btn btn-xs btn-info" ng-click="$ctrl.save()" ng-if="$ctrl.isEditMode()">\n      <i class="fa fa-save" aria-hidden="true"></i> Save comment\n    </button>\n    <button class="btn btn-xs btn-default" ng-click="$ctrl.delete()" ng-if="$ctrl.isEditMode()">\n      <i class="fa fa-times" aria-hidden="true"></i> Delete comment\n    </button>\n    \x3c!--  <button class="btn btn-xs btn-info" ng-click="$ctrl.edit()" ng-hide="$ctrl.comment.editMode"><i class="fa fa-edit"></i> Edit comment</button>--\x3e\n    <button class="btn btn-xs btn-danger delete-comment" ng-click="$ctrl.delete()" ng-if="!$ctrl.isReadonly() && !$ctrl.isEditMode()">\n      <i class="fa fa-times" aria-hidden="true"></i> Delete comment\n    </button>\n    <button class="btn btn-xs btn-info hide-comment" ng-click="$ctrl.hide()" ng-if="!$ctrl.isReadonly() && !$ctrl.isEditMode()">\n      <i class="fa fa-eye-slash" aria-hidden="true"></i> Hide comment\n    </button>\n    <div class="clear"></div>\n  </div>\n  <div class="clear"></div>\n</div>\n'},"./src/common/code-review/code-review-editor.component.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return r});i("./src/common/code-review/codemirror-review-addon.ts");var l=i("./node_modules/jquery/dist/jquery.js"),c=i("./node_modules/angular/index.js"),n=i("./node_modules/lodash/difference.js"),d=i.n(n),o={selector:"codeReviewEditor",bindings:{comments:"<",codeCommentWidgetProvider:"<",fileHash:"<",disableCommentEditing:"<"},controller:(s.$inject=["$compile","$element","$interval","$scope","$timeout","codeMirror","FileService"],s.prototype.$onInit=function(){var n=this,e=this.$scope,t=this.codeMirror,i=!this.disableCommentEditing,o=t.create(this.$element,{readOnly:!0,lineNumbers:!0,gutters:["CodeMirror-linenumbers","hidden-comments"],lineWrapping:!0,selectionPointer:!0,viewportMargin:1/0,allowNewComments:i});o.on("gutterClick",function(e,t){var i=e.lineInfo(t);Array.isArray(e.editorComments)&&e.editorComments.forEach(function(e){e.comment.hidden&&e.comment.endLine===i.line&&(e.comment.hidden=!1)}),n.synchronizeComments()});var s=t.findModeByExtension("java");s&&(o.setOption("mode",s.mime),t.autoLoadMode(o,s.mode)),this.editor=o,e.$on("refreshEditor",function(){n.refreshEditor()}),e.$watch(function(){var e;return null===(e=n.FileService.getActiveContext().file)||void 0===e?void 0:e.content},function(e){e&&(n.editor.getDoc().setValue(e),n.refreshEditor(),n.scrollToLine(n.FileService.getActiveContext().line),n.synchronizeComments())}),e.$watch(function(){var e;return null===(e=n.FileService.getActiveContext().file)||void 0===e?void 0:e.hash},function(e){if(e){var t=n.FileService.getActiveContext();n.setActiveFileWithComments(t.file),n.scrollToLine(t.line)}}),e.$watch(function(){return n.FileService.getActiveContext().line},function(e){n.scrollToLine(e)}),e.$watchCollection(function(){return n.comments},this.synchronizeComments),e.$watch(function(){return Array.isArray(n.comments)?n.comments.filter(function(e){return e.hidden}).length:0},this.synchronizeComments),this.refreshInterval=this.$interval(function(){window.dispatchEvent(new Event("resize"))},500)},s.prototype.$onDestroy=function(){this.$interval.cancel(this.refreshInterval)},s.prototype.refreshEditor=function(){var e=this,t=this.$scope,i=this.$timeout;t.$evalAsync(function(){i(function(){return e.editor.refresh()})})},s.prototype.compileAsLineWidget=function(e,t,i){var n=this.$compile,o=this.$scope,s=this.editor.getDoc(),r=c.element(t),a=o.$new();return c.extend(a,i),n(r)(a),s.addLineWidget(e,r.get(0),{coverGutter:!0,insertAt:0})},s.prototype.makeHiddenCommentMarker=function(){return l('<i class="hidden-comments fa fa-eye-slash" title="Click to show hidden comments"></i>')[0]},s.prototype.scrollToLine=function(e){e<this.editor.lineCount()&&this.editor.scrollIntoView({line:e,ch:0})},s.prototype.setActiveFileWithComments=function(e){var t=this.codeMirror,i=this.editor,n=t.findModeByFileName(e.name);n&&(i.setOption("mode",n.mime),t.autoLoadMode(i,n.mode)),e.content?i.setValue(e.content):i.setValue(""),i.fileHash!==e.hash&&(i.editorComments&&i.editorComments.forEach(function(e){e.lineWidget&&e.lineWidget.clear(),e.codeMarker&&e.codeMarker.clear()}),i.editorComments=[],i.fileHash=e.hash),this.synchronizeComments()},s)};function s(e,t,i,n,o,s,r){var a=this;this.$compile=e,this.$element=t,this.$interval=i,this.$scope=n,this.$timeout=o,this.codeMirror=s,this.FileService=r,this.synchronizeComments=function(){a.$scope.$evalAsync(function(){var s=a.editor;if(s.getValue()){var e=Array.isArray(a.comments)?a.comments:[];a.fileHash&&(e=e.filter(function(e){return e.fileHash===a.fileHash})),Array.isArray(s.editorComments)||(s.editorComments=[]);var r=s.editorComments;e.forEach(function(t){var e=r.find(function(e){return e.comment===t});if(e){var i=(n=e.lineWidget).node;n.node=null,n.clear(),e.lineWidget=s.getDoc().addLineWidget(t.endLine,i,{coverGutter:!0,insertAt:0})}else{var n=a.compileAsLineWidget(t.endLine,a.codeCommentWidgetProvider(),{comment:t,cm:s}),o=s.markText({line:t.startLine,ch:t.startColumn},{line:t.endLine,ch:t.endColumn},{className:"comment-code-selection"});e={comment:t,lineWidget:n,codeMarker:o},r.push(e)}});var t=d()(r.map(function(e){return e.comment}),e);t&&t.forEach(function(t){var e,i,n=r.find(function(e){return e.comment===t});n&&(null!==(e=n.lineWidget)&&void 0!==e&&e.clear(),null!==(i=n.codeMarker)&&void 0!==i&&i.clear(),r.splice(r.indexOf(n),1))}),s.clearGutter("hidden-comments"),r.forEach(function(e){var t=e.comment;t.hidden&&s.setGutterMarker(t.endLine,"hidden-comments",a.makeHiddenCommentMarker())}),a.refreshEditor();for(var i=function(t){if(t.comment.editMode)return a.$timeout(function(){var e=l(t.lineWidget.node).find("textarea");e.is(":focus")||e.focus()},250),"break"},n=0,o=r;n<o.length;n++){if("break"===i(o[n]))break}}})}}var r=c.module("exam.codeReviewEditor",[]).component(o.selector,o).name},"./src/common/code-review/code-review.module.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return b});var n=i("./node_modules/angular/index.js"),o=i("./src/common/code-review/comment-service.ts"),s=i("./src/common/services/dialogs.service.ts"),r={selector:"codeComment",template:i("./src/common/code-review/code-comment.component.html"),bindings:{comment:"<",codeMirror:"<",readonly:"<"},controller:(a.$inject=["$element","$q","$scope","$timeout","commentService","dialogs"],a.prototype.$onInit=function(){var t=this;this.initHotkeys(),this.$scope.$watch(function(){var e;return null===(e=t.comment)||void 0===e?void 0:e.editMode},function(e){e&&(t.commentModel=t.comment.text,t.$timeout(function(){return t.scrollIntoView()},100))})},a.prototype.$onChanges=function(e){this.comment=this.comment||{},e.comment&&(this.commentModel=this.comment.text)},a.prototype.isReadonly=function(){return this.readonly},a.prototype.isEditMode=function(){return!this.readonly&&this.comment.editMode},a.prototype.delete=function(){var e,t=this;this.isReadonly()||((null!==(e=this.comment)&&void 0!==e&&e.text?this.dialogs.confirm("Confirm delete","Are you sure that you want to permanently delete the selected comment?").result:this.$q.resolve()).then(function(){t.commentService.removeComment(t.comment),t.codeMirror.refresh()}),this.codeMirror.refresh())},a.prototype.hide=function(){this.comment.hidden=!0,this.codeMirror.refresh()},a.prototype.edit=function(){var e=this;if(!this.isReadonly()){var t=this.commentService,i=t.getActiveComment();i&&i!==this.comment&&t.closeEditMode(i),t.openEditMode(this.comment),this.$scope.$evalAsync(function(){e.$timeout(function(){return e.$element.find("textarea").focus()},100),e.codeMirror.refresh()})}},a.prototype.save=function(){this.saveComment(this.comment)},a.prototype.saveComment=function(t){var i=this;t.text=this.commentModel,this.commentService.closeEditMode(t),this.$scope.$evalAsync(function(){i.$timeout(function(){var e=i.codeMirror;e.refresh(),e.focus(),e.getDoc().setSelection({line:t.endLine,ch:t.endColumn})},100)})},a.prototype.initHotkeys=function(){null!==window&&void 0!==window&&window.navigator.platform.includes("Mac")?(this.hotkeysMessage="Press ⌘+S or ⌘+Enter to save the comment",this.hotkeys={"meta+s":this.hotkeySave,"meta+enter":this.hotkeySave,esc:this.hotkeyEscape}):(this.hotkeysMessage="Press Ctrl+S or Ctrl+Enter to save the comment",this.hotkeys={"ctrl+s":this.hotkeySave,"ctrl+enter":this.hotkeySave,esc:this.hotkeyEscape})},a.prototype.handleKeyDown=function(e){var t,i,n=[e.metaKey&&"meta",e.ctrlKey&&"ctrl","Esc"===e.key||"Escape"===e.key&&"esc","Enter"===e.key&&"enter",1===e.key.length&&e.key].filter(Boolean).join("+");null!==(i=(t=this.hotkeys)[n])&&void 0!==i&&i.call(t,e)},a.prototype.scrollIntoView=function(){var e,t=this.comment,i=this.codeMirror,n=i.lineCount();e=t.startLine<n-10?Math.max(0,t.startLine-1):Math.min(t.endLine+8,i.lineCount()-1),i.scrollIntoView({line:e,ch:0})},a)};function a(e,t,i,n,o,s){var r=this;this.$element=e,this.$q=t,this.$scope=i,this.$timeout=n,this.commentService=o,this.dialogs=s,this.hotkeySave=function(e){e.preventDefault(),r.saveComment(r.comment)},this.hotkeyEscape=function(){r.comment.text?(r.commentModel=r.comment.text,r.commentService.closeEditMode(r.comment)):r.commentService.removeComment(r.comment),r.codeMirror.refresh()}}var l=n.module("exam.codeComment",[o.a,s.a]).component(r.selector,r).name,c=i("./src/common/code-review/code-review-editor.component.ts"),d={selector:"examFileCommentsEditor",template:'\n    <code-review-editor\n      class="code-review-editor-wrapper"\n      disable-comment-editing="$ctrl.readonly"\n      comments="$ctrl.comments"\n      code-comment-widget-provider="$ctrl.codeCommentWidgetProvider"\n      file-hash="$ctrl.fileHash"\n    ></code-review-editor>\n  ',bindings:{comments:"<",fileHash:"<",readonly:"<"},controller:(u.$inject=["commentService"],u.prototype.$onChanges=function(){this.commentService.setComments(this.comments)},u)};function u(e){var t=this;this.commentService=e,this.codeCommentWidgetProvider=function(){return'<code-comment comment="comment" code-mirror="cm" readonly="'+Boolean(t.readonly)+'"></code-comment>'}}var p={selector:"fileAnswerComments",template:'\n    <code-review-editor\n      class="code-review-editor-wrapper"\n      disable-comment-editing="true"\n      code-comment-widget-provider="$ctrl.codeCommentWidgetProvider"\n      comments="$ctrl.comments[$ctrl.fileHash]"\n    ></code-review-editor>\n  ',bindings:{comments:"<",fileHash:"<"},controller:(h.prototype.codeCommentWidgetProvider=function(){return'<div code-comment-from-answer="comment" code-mirror="cm"></div>'},h)};function h(){}var m={selector:"fileReferenceComments",template:'\n    <code-review-editor\n      class="code-review-editor-wrapper"\n      disable-comment-editing="true"\n      comments="$ctrl.comments"\n      code-comment-widget-provider="$ctrl.codeCommentWidgetProvider"\n    ></code-review-editor>\n  ',bindings:{referenceComments:"<",fileHash:"<"},controller:(f.prototype.$onChanges=function(e){if(e.fileHash){var t=this.fileHash;this.referenceComments&&t?(this.referenceComments[t]||(this.referenceComments[t]=[]),this.comments=this.referenceComments[t]):this.comments=[]}},f.prototype.$onInit=function(){},f.prototype.codeCommentWidgetProvider=function(){return'<code-comment comment="comment" code-mirror="cm" readonly="true"></code-comment>'},f)};function f(){this.comments=[]}var v={selector:"fileReferenceCommentsEditor",template:'\n    <code-review-editor\n      class="code-review-editor-wrapper"\n      disable-comment-editing="false"\n      comments="$ctrl.comments"\n      code-comment-widget-provider="$ctrl.codeCommentWidgetProvider"\n    ></code-review-editor>\n  ',bindings:{referenceComments:"<",fileHash:"<"},controller:(g.$inject=["$rootScope","$scope","commentService"],g.prototype.$onChanges=function(e){if(e.fileHash){var t=this.fileHash;this.referenceComments&&t?(this.referenceComments[t]||(this.referenceComments[t]=[]),this.comments=this.referenceComments[t]):this.comments=[],this.commentService.setComments(this.comments)}},g.prototype.$onInit=function(){var e=this,t=this.$scope;t.$watch(function(){return e.comments},function(){e.updateCommentsCounts()},!0),t.$on("fileTree.synchronized",function(){e.updateCommentsCounts()})},g.prototype.updateCommentsCounts=function(){var n={};Object.entries(this.referenceComments).forEach(function(e){var t=e[0],i=e[1];n[encodeURIComponent(t)]=i.length}),this.$rootScope.$broadcast("updateCommentsCounts",n)},g.prototype.codeCommentWidgetProvider=function(){return'<code-comment comment="comment" code-mirror="cm" readonly="false"></code-comment>'},g)};function g(e,t,i){this.$rootScope=e,this.$scope=t,this.commentService=i}var b=n.module("common.codeReview",[o.a,l,c.a]).component(d.selector,d).component(p.selector,p).component(m.selector,m).component(v.selector,v).name},"./src/common/code-review/codemirror-review-addon.ts":function(e,t,i){"use strict";var s=i("./node_modules/jquery/dist/jquery.js"),n=i("./node_modules/angular/index.js"),r=i("./node_modules/codemirror/lib/codemirror.js");function c(e){e.commentTooltip&&(e.commentTooltip.style.display="none")}function a(r){var e=r.getDoc(),a=n.element(r.getWrapperElement()),t=e.listSelections(),l=t.length&&t[0];l&&(e.setSelection(l.head),c(r),a.injector().invoke(["commentService",function(t){var i=l.head.line,n=l.head.ch,o=l.anchor.line,s=l.anchor.ch;(o<i||o===i&&s<n)&&(i=l.anchor.line,n=l.anchor.ch,o=l.head.line,s=l.head.ch),a.scope().$apply(function(){t.getComments().forEach(function(e){t.closeEditMode(e)});var e={fileHash:r.fileHash,text:"",startLine:i,startColumn:n,endLine:o,endColumn:s};t.addComment(e),t.openEditMode(e)})}]),c(r))}r.defineOption("allowNewComments",!1,function(e,t,i){var n,o=i&&i!==r.Init;t&&!o&&(e.setOption("extraKeys",{C:a}),(n=e).commentTooltip=s('<div class="CodeMirror-tooltip">Press c to add a comment</div>').get(0),n.commentTooltip.style.display="none",document.body.appendChild(n.commentTooltip),n.commentTooltip,e.on("beforeSelectionChange",function(e,t){var i,n,o,s,r=t.ranges;if(r&&r[0]&&!r[0].empty()){var a=r[0],l=e.cursorCoords(a.head,"page");i=e,n=l.left,o=l.top,(s=i.commentTooltip)&&(s.style.left=n+"px",s.style.top=o+"px",s.style.display="block")}else c(e)}))})},"./src/common/code-review/comment-service.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("./node_modules/angular/index.js"),o=(s.prototype.addComment=function(e){var t=this.comments;e.editMode=!0,e.hidden=!1,e.uiId="comment-"+Date.now(),t.push(e)},s.prototype.openEditMode=function(e){this.comments.filter(function(e){return e.editMode}).forEach(function(e){e.editMode=!1}),e.editMode=!0,e.hidden=!1,this.activeComment=e},s.prototype.closeEditMode=function(e){e.editMode=!1,e===this.activeComment&&(this.activeComment=null)},s.prototype.removeComment=function(e){var t=this.comments;t.splice(t.indexOf(e),1)},s.prototype.setComments=function(e){this.comments=Array.isArray(e)?e:[]},s.prototype.getFileComments=function(t){return this.comments.filter(function(e){return e.fileHash===t})},s.prototype.getComments=function(){return this.comments},s.prototype.getActiveComment=function(){return this.activeComment},s);function s(){this.comments=[]}var r=n.module("exam.commentService",[]).service("commentService",o).name},"./src/common/dvsk-ng-components/dvsk-file-button/dvsk-file-button.component.html":function(e,t){e.exports='<input type="file" ngf-select="$ctrl.onFileSelect({ $files: $files })" ngf-multiple="$ctrl.multiple" />\n<button dvsk-button size="{{ $ctrl.size }}" full-width="$ctrl.fullWidth" tabindex="-1" ng-transclude></button>\n'},"./src/common/dvsk-ng-components/dvsk-file-button/dvsk-file-button.component.less":function(e,t,i){},"./src/common/files/file-tree/file-tree.component.html":function(e,t){e.exports='<div class="tree"></div>\n'},"./src/common/files/file-tree/file-tree.component.less":function(e,t,i){},"./src/common/files/file-tree/index.ts":function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i("./node_modules/angular/index.js"),r=(i("./node_modules/jstree/dist/jstree.js"),i("./node_modules/jquery/dist/jquery.js")),o="newFileModal",s={selector:"fileTree",template:i("./src/common/files/file-tree/file-tree.component.html"),styles:[i("./src/common/files/file-tree/file-tree.component.less")],bindings:{onSelect:"&",contextMenu:"<?"},controller:(a.$inject=["$element","$rootScope","$scope","dialogs","FileService"],a.prototype.$onInit=function(){var r=this,a=this.$element,e=this.$scope,l=this.FileService;e.$on("updateCommentsCounts",function(e,t){r.decorateFileTreeWithCommentCounts(r.jstree,t)}),e.$watchCollection(function(){return[l.currentTask,l.getFiles().length]},function(e,t){var i=e[0],n=e[1],o=t[0],s=t[1];(i&&i.id)!==(o&&o.id)&&(r.jstree=null,a.jstree("destroy")),r.treeModel=l.getJstreeModel(),(s||0<n)&&(r.jstree?r.synchronizeTreeStructure():r.jstree=r.initTree())}),e.$watch(function(){return l.getActiveFileHash()},function(e){r.selectTreeNodeByHash(e)})},a.prototype.executeContextMenuAction=function(e,t){var i=r.jstree.reference(t.reference),n=i.get_node(t.reference);e(i.get_path(n,"/")+"/",n.original.hash)},a.prototype.initTree=function(){var o=this,e={core:{check_callback:!0,data:this.treeModel,themes:{dots:!1}},types:{DIRECTORY:{icon:"fa fa-folder-o"},default:{icon:"fa fa-file-o"}},sort:function(e,t){var i=this.get_node(t),n=this.get_node(e);return n.type===i.type?n.text>i.text?1:-1:"DIRECTORY"!==n.type&&("DIRECTORY"===i.type||n.text>i.text)?1:-1},plugins:["types","wholerow","sort"]};this.contextMenu&&(e.plugins.push("contextmenu"),e.contextmenu={items:{new_file:{label:"New file",_disabled:this.isFileNode,icon:"fa fa-file",action:function(e){o.executeContextMenuAction(o.newFile,e)}},new_directory:{label:"New directory",_disabled:this.isFileNode,icon:"fa fa-folder",action:function(e){o.executeContextMenuAction(o.newDirectory,e)}},remove:{label:"Remove",icon:"fa fa-trash-o",action:function(e){o.executeContextMenuAction(o.removeFile,e)}}}});var s=this.$element,t=s.jstree(e);return t.on("loaded.jstree",function(){o.$scope.$apply(function(){o.$rootScope.$broadcast("fileTree.synchronized")})}),t.on("after_open.jstree",function(){t.hashesCount&&o.decorateFileTreeWithCommentCounts(t,t.hashesCount)}),s.on("changed.jstree",function(e,t){if("select_node"===t.action){var i=t.event,n=2===i.button||"contextmenu"===i.type;o.selectTreeNode(t,!n)}}),s.on("before_open.jstree",function(e,t){if(t.node&&t.node.children&&1===t.node.children.length){var i=t.node.children[0],n=s.jstree(!0),o=n.get_node(i);"DIRECTORY"===o.type&&n.open_node(o)}}),t},a.prototype.selectTreeNodeByHash=function(i){var e,t=this,n=this.$element.jstree(!0),o=(null===(e=n._model)||void 0===e?void 0:e.data)||{},s=Object.values(o).find(function(e){var t;return(null===(t=null==e?void 0:e.original)||void 0===t?void 0:t.hash)===i});s&&this.$scope.$applyAsync(function(){n.activate_node(s,{}),t.updateSelectedLocation()})},a.prototype.updateSelectedLocation=function(e){var t=this.$element.jstree(!0),i=t.get_selected(!0);if(this.selectedLocation="",i&&i.length){var n=i[0];"DIRECTORY"===n.type?(this.selectedLocation=t.get_path(n,"/"),this.selectedLocationHash=n.original.hash,e&&t.toggle_node(n)):"#"!==n.parent&&(this.selectedLocation=t.get_path(n.parent,"/"),this.selectedLocationHash=t.get_node(n.parent).original.hash)}this.selectedLocation&&(this.selectedLocation+="/")},a.prototype.selectTreeNode=function(e,t){"folder"!==e.node.type&&t&&this.FileService.openFile(e.node.original.hash),this.updateSelectedLocation(t),this.$scope.$applyAsync()},a.prototype.decorateFileTreeWithCommentCounts=function(e,s){e&&(e.hashesCount!==s&&(e.hashesCount=s),r("a[filehash]").each(function(e,t){var i=r(t),n=i.attr("filehash"),o=i.find(".comments-count");s[n]?(i.hasClass("file-with-comments")||i.addClass("file-with-comments"),o.length?o.text(" ("+s[n]+")"):i.append('<span class="comments-count"> ('+s[n]+")</span>")):(i.hasClass("file-with-comments")&&i.removeClass("file-with-comments"),o.length&&o.remove())}))},a.prototype.extractTreeNodesFromTree=function(e){return Object.values(e._model.data).map(function(e){return e&&e.original}).filter(Boolean)},a.prototype.synchronizeTreeStructure=function(){var o=this.FileService,s=this.$element.jstree(!0);this.treeModel=o.getJstreeModel();var r=this.extractTreeNodesFromTree(s);r.forEach(function(e){e&&(o.fileExists(e.hash)||s.delete_node(e))}),o.getFileHashes().forEach(function(t){if(!r.find(function(e){return e.hash===t})){var i=o.getParentHash(t),e="#";i&&(e=r.find(function(e){return e.hash===i}));var n=o.getJstreeNode(t);s.create_node(e,n)}}),s.redraw(),this.$rootScope.$broadcast("fileTree.synchronized")},a.prototype.openNewFileModal=function(e,t,i){this.dialogs.open({component:o,resolve:{location:function(){return e},locationHash:function(){return t},directoryMode:function(){return i}},size:"lg",keyboard:!0,backdrop:"static",windowClass:"colored-header"})},a)};function a(e,t,i,n,o){var s=this;this.$element=e,this.$rootScope=t,this.$scope=i,this.dialogs=n,this.FileService=o,this.isFileNode=function(e){return!!e&&"DIRECTORY"!==r.jstree.reference(e.reference).get_node(e.reference).type},this.removeFile=function(e,t){return s.dialogs.confirm("Delete file","Are you sure you want to delete the selected file?").result.then(function(){return s.FileService.deleteFile(t)})},this.newFile=function(e,t){s.openNewFileModal(e,t,!1)},this.newDirectory=function(e,t){s.openNewFileModal(e,t,!0)},this.$element.addClass(this.$element[0].tagName.toLowerCase())}var l=n.module("common.files.fileTree",[]).component(s.selector,s).name}}]);